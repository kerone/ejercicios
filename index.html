<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Academia Pokemon - ¬°Aprende Jugando!</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Nunito:wght@400;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #ff6b6b 0%, #4ecdc4 25%, #45b7d1 50%, #96ceb4 75%, #ffeaa7 100%);
            background-size: 400% 400%;
            animation: gradientShift 8s ease infinite;
            min-height: 100vh;
            color: #2d3436;
            overflow-x: hidden;
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .login-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            position: relative;
        }

        .login-card {
            background: white;
            padding: 50px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            text-align: center;
            max-width: 500px;
            width: 100%;
            position: relative;
            z-index: 2;
            border: 5px solid transparent;
            background-clip: padding-box;
        }

        .login-card::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
            border-radius: 35px;
            z-index: -1;
        }

        .login-card h1 {
            font-family: 'Fredoka One', cursive;
            color: #ff6b6b;
            margin-bottom: 20px;
            font-size: 3em;
            text-shadow: 3px 3px 0px #fff;
        }

        .login-card p {
            font-size: 18px;
            color: #636e72;
            margin-bottom: 30px;
            font-weight: 600;
        }

        .login-card input {
            width: 100%;
            padding: 20px;
            margin: 15px 0;
            border: 3px solid #ddd;
            border-radius: 20px;
            font-size: 18px;
            font-family: 'Nunito', sans-serif;
            font-weight: 600;
            transition: all 0.3s;
            background: #f8f9fa;
        }

        .login-card input:focus {
            outline: none;
            border-color: #ff6b6b;
            transform: scale(1.02);
            background: white;
        }

        .login-card button {
            width: 100%;
            padding: 20px;
            background: linear-gradient(45deg, #ff6b6b, #fd79a8);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 20px;
            font-weight: 800;
            cursor: pointer;
            margin-top: 15px;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
            font-family: 'Nunito', sans-serif;
        }

        .login-card button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(255, 107, 107, 0.6);
        }

        .main-app {
            display: none;
        }

        .header {
            background: white;
            padding: 25px;
            border-radius: 25px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border: 3px solid #fdcb6e;
            flex-wrap: wrap;
            gap: 15px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 35px;
            color: white;
            font-weight: 800;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            border: 4px solid white;
        }

        .user-info h2 {
            font-family: 'Fredoka One', cursive;
            font-size: 24px;
            color: #2d3436;
            margin: 0;
        }

        .user-info p {
            font-size: 16px;
            color: #636e72;
            margin: 5px 0 0 0;
            font-weight: 600;
        }

        .stats {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 20px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(116, 185, 255, 0.3);
            min-width: 100px;
            transition: transform 0.3s;
            border: 3px solid white;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card:nth-child(2) {
            background: linear-gradient(135deg, #55efc4, #00b894);
            box-shadow: 0 8px 25px rgba(85, 239, 196, 0.3);
        }

        .stat-card:nth-child(3) {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            box-shadow: 0 8px 25px rgba(253, 203, 110, 0.3);
        }

        .stat-card h3 {
            font-size: 28px;
            font-weight: 800;
            margin: 5px 0;
            font-family: 'Fredoka One', cursive;
        }

        .stat-card p {
            font-size: 14px;
            opacity: 0.95;
            font-weight: 700;
        }

        .tab-navigation {
            background: white;
            padding: 15px;
            border-radius: 25px;
            margin-bottom: 25px;
            display: flex;
            gap: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border: 3px solid #4ecdc4;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-tab {
            padding: 15px 30px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 3px solid #dfe6e9;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 800;
            font-size: 16px;
            color: #2d3436;
            font-family: 'Nunito', sans-serif;
        }

        .nav-tab:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #ff6b6b, #fd79a8);
            color: white;
            border-color: #d63031;
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .calendar-wrapper {
            background: white;
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
            border: 4px solid #74b9ff;
        }

        .calendar-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .calendar-header h2 {
            font-family: 'Fredoka One', cursive;
            font-size: 32px;
            color: #2d3436;
            margin-bottom: 10px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .day-header {
            font-family: 'Fredoka One', cursive;
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border-radius: 15px;
            font-size: 16px;
            border: 3px solid white;
        }

        .day-cell {
            aspect-ratio: 1;
            border: 4px solid #dfe6e9;
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            position: relative;
            overflow: hidden;
        }

        .day-cell:hover:not(.disabled):not(.empty) {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .day-cell.empty {
            opacity: 0.3;
            cursor: default;
            background: #f8f9fa;
        }

        .day-cell.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #f8f9fa;
        }

        .day-cell.recoverable {
            background: linear-gradient(135deg, #fab1a0, #ff7675);
            border-color: #d63031;
            cursor: pointer;
            animation: pulseRecoverable 2s infinite;
        }

        @keyframes pulseRecoverable {
            0%, 100% { box-shadow: 0 0 15px rgba(255, 118, 117, 0.4); }
            50% { box-shadow: 0 0 25px rgba(255, 118, 117, 0.7); }
        }

        .day-cell.recoverable:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(255, 118, 117, 0.8);
        }

        .day-cell.completed {
            background: linear-gradient(135deg, #55efc4, #00b894);
            border-color: #00b894;
            animation: pulseGlow 2s infinite;
        }

        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 184, 148, 0.5); }
            50% { box-shadow: 0 0 40px rgba(0, 184, 148, 0.8); }
        }

        .day-cell.current {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            border-color: #d63031;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .day-number {
            font-family: 'Fredoka One', cursive;
            font-size: 24px;
            font-weight: 800;
            color: #2d3436;
        }

        .day-cell.completed .day-number,
        .day-cell.current .day-number,
        .day-cell.recoverable .day-number {
            color: white;
        }

        .day-status {
            font-size: 30px;
            margin-top: 5px;
        }

        .exercise-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }

        .exercise-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            max-width: 900px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            border: 5px solid #4ecdc4;
            position: relative;
            margin: 20px auto;
            max-height: 90vh;
            overflow-y: auto;
        }

        .exercise-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .exercise-header h3 {
            font-family: 'Fredoka One', cursive;
            font-size: 32px;
            color: #2d3436;
            margin-bottom: 15px;
        }

        .subject-badge {
            display: inline-block;
            padding: 12px 25px;
            border-radius: 20px;
            font-weight: 800;
            font-size: 18px;
            margin: 5px;
            border: 3px solid white;
        }

        .subject-badge.math {
            background: linear-gradient(135deg, #ff6b6b, #fd79a8);
            color: white;
        }

        .subject-badge.reading {
            background: linear-gradient(135deg, #4ecdc4, #45b7d1);
            color: white;
        }

        .subject-badge.science {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
        }

        .subject-badge.social {
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            color: white;
        }

        .instruction-box {
            background: linear-gradient(135deg, #dfe6e9, #b2bec3);
            padding: 25px;
            border-radius: 20px;
            margin: 20px 0;
            border: 4px solid #636e72;
        }

        .instruction-box h4 {
            font-family: 'Fredoka One', cursive;
            font-size: 22px;
            color: #2d3436;
            margin-bottom: 15px;
        }

        .instruction-box p {
            font-size: 18px;
            font-weight: 700;
            color: #2d3436;
            line-height: 1.6;
        }

        .reading-passage {
            background: linear-gradient(135deg, #fff9e6, #ffeaa7);
            padding: 30px;
            border-radius: 20px;
            margin: 20px 0;
            border: 4px solid #fdcb6e;
            font-size: 18px;
            line-height: 2;
            font-weight: 600;
            color: #2d3436;
            max-height: 400px;
            overflow-y: auto;
        }

        .reading-passage h4 {
            font-family: 'Fredoka One', cursive;
            font-size: 24px;
            margin-bottom: 20px;
            color: #e17055;
            text-align: center;
        }

        .reading-passage p {
            margin-bottom: 15px;
        }

        .question-container {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 30px;
            border-radius: 25px;
            margin: 25px 0;
            border: 4px solid #dfe6e9;
        }

        .question-text {
            font-size: 22px;
            font-weight: 700;
            color: #2d3436;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options-container {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .option-btn {
            padding: 20px;
            background: white;
            border: 4px solid #dfe6e9;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 18px;
            font-weight: 700;
            text-align: left;
            color: #2d3436;
            font-family: 'Nunito', sans-serif;
        }

        .option-btn:hover {
            transform: translateX(10px);
            border-color: #74b9ff;
            box-shadow: 0 8px 25px rgba(116, 185, 255, 0.3);
        }

        .option-btn.selected {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border-color: #0984e3;
        }

        .option-btn.correct {
            background: linear-gradient(135deg, #55efc4, #00b894);
            color: white;
            border-color: #00b894;
        }

        .option-btn.incorrect {
            background: linear-gradient(135deg, #ff7675, #d63031);
            color: white;
            border-color: #d63031;
        }

        .hint-box {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            padding: 20px;
            border-radius: 20px;
            margin: 20px 0;
            border: 4px solid #e17055;
            display: none;
        }

        .hint-box.visible {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hint-text {
            font-size: 18px;
            font-weight: 700;
            color: #2d3436;
        }

        .feedback-box {
            padding: 25px;
            border-radius: 20px;
            margin: 20px 0;
            font-size: 18px;
            font-weight: 700;
            border: 4px solid;
            display: none;
            line-height: 1.6;
        }

        .feedback-box.visible {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .feedback-box.correct {
            background: linear-gradient(135deg, #55efc4, #00b894);
            color: white;
            border-color: #00b894;
        }

        .feedback-box.incorrect {
            background: linear-gradient(135deg, #ff7675, #d63031);
            color: white;
            border-color: #d63031;
        }

        .explanation-box {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            padding: 25px;
            border-radius: 20px;
            margin: 20px 0;
            border: 4px solid #2196f3;
            display: none;
            font-size: 17px;
            line-height: 1.7;
            font-weight: 600;
            color: #1565c0;
        }

        .explanation-box.visible {
            display: block;
            animation: slideIn 0.3s ease;
        }

        .explanation-box h4 {
            font-family: 'Fredoka One', cursive;
            font-size: 22px;
            margin-bottom: 15px;
            color: #0d47a1;
        }

        .exercise-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .exercise-btn {
            flex: 1;
            min-width: 150px;
            padding: 18px;
            border: none;
            border-radius: 20px;
            font-size: 18px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        .exercise-btn.primary {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            box-shadow: 0 8px 25px rgba(116, 185, 255, 0.4);
        }

        .exercise-btn.primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(116, 185, 255, 0.6);
        }

        .exercise-btn.secondary {
            background: linear-gradient(135deg, #dfe6e9, #b2bec3);
            color: #2d3436;
        }

        .exercise-btn.secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .exercise-btn.success {
            background: linear-gradient(135deg, #55efc4, #00b894);
            color: white;
            box-shadow: 0 8px 25px rgba(0, 184, 148, 0.4);
        }

        .exercise-btn.success:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0, 184, 148, 0.6);
        }

        .exercise-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .progress-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
        }

        .progress-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #dfe6e9;
            border: 3px solid #b2bec3;
            transition: all 0.3s;
        }

        .progress-dot.completed {
            background: linear-gradient(135deg, #55efc4, #00b894);
            border-color: #00b894;
        }

        .progress-dot.current {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            border-color: #e17055;
            transform: scale(1.3);
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff7675, #d63031);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 800;
            box-shadow: 0 8px 20px rgba(214, 48, 49, 0.4);
        }

        .close-modal:hover {
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 12px 30px rgba(214, 48, 49, 0.6);
        }

        .achievement-unlock {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 50px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 2000;
            text-align: center;
            border: 5px solid #fdcb6e;
            display: none;
            animation: achievementPop 0.5s ease;
        }

        @keyframes achievementPop {
            0% {
                transform: translate(-50%, -50%) scale(0);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .achievement-unlock.visible {
            display: block;
        }

        .achievement-icon-big {
            font-size: 100px;
            margin-bottom: 20px;
        }

        .achievement-unlock h3 {
            font-family: 'Fredoka One', cursive;
            font-size: 32px;
            color: #2d3436;
            margin-bottom: 15px;
        }

        .achievement-unlock p {
            font-size: 20px;
            font-weight: 700;
            color: #636e72;
        }

        .stats-kids {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .stat-card-big {
            background: linear-gradient(135deg, #f8f9fa, white);
            padding: 40px;
            border-radius: 25px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            border: 4px solid #74b9ff;
            transition: all 0.3s;
        }

        .stat-card-big:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 50px rgba(0,0,0,0.2);
        }

        .stat-icon-big {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .stat-number-big {
            font-family: 'Fredoka One', cursive;
            font-size: 48px;
            color: #2d3436;
            margin-bottom: 10px;
        }

        .stat-label-big {
            font-size: 18px;
            font-weight: 700;
            color: #636e72;
        }

        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .achievement-card {
            background: linear-gradient(135deg, #dfe6e9, #b2bec3);
            padding: 30px;
            border-radius: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 4px solid #636e72;
            transition: all 0.3s;
            opacity: 0.5;
        }

        .achievement-card.unlocked {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            border-color: #e17055;
            opacity: 1;
            animation: achievementGlow 2s infinite;
        }

        @keyframes achievementGlow {
            0%, 100% { box-shadow: 0 10px 30px rgba(253, 203, 110, 0.4); }
            50% { box-shadow: 0 10px 40px rgba(253, 203, 110, 0.8); }
        }

        .achievement-card:hover {
            transform: scale(1.05);
        }

        .achievement-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .ranking-container {
            background: white;
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
            border: 4px solid #fdcb6e;
        }

        .ranking-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .ranking-header h2 {
            font-family: 'Fredoka One', cursive;
            font-size: 32px;
            color: #2d3436;
        }

        .ranking-filters {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 25px 0;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #dfe6e9, #b2bec3);
            border: 3px solid #636e72;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 800;
            font-size: 16px;
            color: #2d3436;
            transition: all 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        .filter-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            border-color: #e17055;
        }

        .podium {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 20px;
            margin: 40px 0;
            min-height: 300px;
        }

        .podium-place {
            text-align: center;
            padding: 30px 20px;
            border-radius: 20px;
            border: 4px solid;
            min-width: 200px;
            transition: all 0.3s;
        }

        .podium-place:hover {
            transform: translateY(-10px);
        }

        .podium-place.first {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            border-color: #d63031;
            order: 2;
            height: 300px;
        }

        .podium-place.second {
            background: linear-gradient(135deg, #dfe6e9, #b2bec3);
            border-color: #636e72;
            order: 1;
            height: 240px;
        }

        .podium-place.third {
            background: linear-gradient(135deg, #fab1a0, #e17055);
            border-color: #d63031;
            order: 3;
            height: 200px;
        }

        .podium-rank {
            font-family: 'Fredoka One', cursive;
            font-size: 48px;
            color: white;
            margin-bottom: 10px;
        }

        .podium-name {
            font-size: 20px;
            font-weight: 800;
            color: white;
            margin-bottom: 10px;
        }

        .podium-score {
            font-family: 'Fredoka One', cursive;
            font-size: 24px;
            color: white;
        }

        .ranking-table {
            margin-top: 30px;
        }

        .ranking-row {
            display: flex;
            align-items: center;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, white);
            border-radius: 20px;
            margin-bottom: 15px;
            border: 3px solid #dfe6e9;
            transition: all 0.3s;
        }

        .ranking-row:hover {
            transform: translateX(10px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .ranking-row.current-user {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            border-color: #0984e3;
        }

        .ranking-row.current-user * {
            color: white !important;
        }

        .ranking-position {
            font-family: 'Fredoka One', cursive;
            font-size: 28px;
            color: #2d3436;
            min-width: 60px;
            text-align: center;
        }

        .ranking-user {
            flex: 1;
            font-size: 20px;
            font-weight: 800;
            color: #2d3436;
            margin-left: 20px;
        }

        .ranking-stats {
            display: flex;
            gap: 30px;
            font-weight: 700;
            color: #636e72;
        }

        .connection-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 25px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            z-index: 1500;
            font-weight: 800;
            border: 3px solid;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .connection-status.online {
            border-color: #00b894;
            color: #00b894;
        }

        .connection-status.offline {
            border-color: #636e72;
            color: #636e72;
        }

        .connection-status.connecting {
            border-color: #fdcb6e;
            color: #e17055;
        }

        .connection-status.error {
            border-color: #d63031;
            color: #d63031;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: currentColor;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .settings-container {
            background: white;
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 15px 50px rgba(0,0,0,0.1);
            border: 4px solid #74b9ff;
        }

        .settings-section {
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 3px solid #dfe6e9;
        }

        .settings-section:last-child {
            border-bottom: none;
        }

        .settings-section h3 {
            font-family: 'Fredoka One', cursive;
            font-size: 24px;
            color: #2d3436;
            margin-bottom: 20px;
        }

        .settings-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #dfe6e9, #b2bec3);
            border: 3px solid #636e72;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 800;
            font-size: 16px;
            color: #2d3436;
            margin: 10px 0;
            transition: all 0.3s;
            font-family: 'Nunito', sans-serif;
        }

        .settings-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .settings-btn.danger {
            background: linear-gradient(135deg, #ff7675, #d63031);
            color: white;
            border-color: #d63031;
        }

        .settings-btn.success {
            background: linear-gradient(135deg, #55efc4, #00b894);
            color: white;
            border-color: #00b894;
        }

        .timer-display {
            font-family: 'Fredoka One', cursive;
            font-size: 28px;
            color: #2d3436;
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            border-radius: 20px;
            border: 4px solid #e17055;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header {
                padding: 15px;
                flex-direction: column;
                gap: 15px;
            }

            .user-info {
                flex-direction: column;
                text-align: center;
                width: 100%;
            }

            .avatar {
                width: 60px;
                height: 60px;
                font-size: 28px;
            }

            .stats {
                width: 100%;
                justify-content: space-around;
            }

            .stat-card {
                min-width: 80px;
                padding: 12px;
            }

            .stat-card h3 {
                font-size: 20px;
            }

            .stat-card p {
                font-size: 12px;
            }

            .tab-navigation {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                -ms-overflow-style: none;
            }

            .tab-navigation::-webkit-scrollbar {
                display: none;
            }

            .nav-tab {
                min-width: 120px;
                padding: 12px 15px;
                font-size: 14px;
                white-space: nowrap;
            }

            .calendar-grid {
                grid-template-columns: repeat(7, 1fr);
                gap: 6px;
            }

            .day-cell {
                min-height: 60px;
                padding: 5px;
            }

            .day-number {
                font-size: 14px;
            }

            .day-status {
                font-size: 18px;
            }

            .exercise-content {
                padding: 15px;
            }

            .exercise-modal {
                padding: 15px;
            }

            .option-btn {
                padding: 12px;
                font-size: 15px;
            }

            .podium {
                flex-direction: column;
                align-items: center;
                gap: 15px;
            }

            .podium-place {
                width: 100%;
                max-width: 300px;
                height: auto !important;
            }

            .podium-place.first {
                order: 1;
            }

            .podium-place.second {
                order: 2;
            }

            .podium-place.third {
                order: 3;
            }

            .ranking-table {
                font-size: 14px;
            }

            .ranking-row td {
                padding: 10px 5px;
                font-size: 13px;
            }

            .achievement-grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .calendar-header h2 {
                font-size: 24px;
            }

            .login-card {
                padding: 30px 20px;
                margin: 10px;
            }

            .login-card h1 {
                font-size: 2em;
            }
        }

        /* Media query espec√≠fica para pantallas grandes (S24 Ultra y similares) */
        @media (min-width: 769px) and (max-width: 1024px) {
            .calendar-grid {
                gap: 10px;
            }

            .day-cell {
                min-height: 80px;
            }

            .nav-tab {
                padding: 15px 20px;
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="connection-status" id="connectionStatus">
        <div class="status-dot"></div>
        <span id="statusText">Desconectado</span>
    </div>

    <div class="login-screen" id="loginScreen">
        <div class="login-card">
            <h1>üéÆ Academia Pokemon</h1>
            <p>¬°Bienvenido, S√∫per Entrenador! üöÄ</p>
            <input type="text" id="usernameInput" placeholder="Escribe tu nombre de entrenador">
            <input type="password" id="passwordInput" placeholder="Escribe tu contrase√±a secreta üîê" style="margin-top: 15px;">
            <button onclick="login()">¬°Comenzar Aventura! üåü</button>
        </div>
    </div>

    <div class="main-app" id="mainApp">
        <div class="container">
            <div class="header">
                <div class="user-info">
                    <div class="avatar" id="userAvatar">üéÆ</div>
                    <div>
                        <h2 id="userName">S√∫per Entrenador</h2>
                        <p id="userLevel">Nivel 1 - Novato Genial</p>
                    </div>
                </div>
                <div class="stats">
                    <div class="stat-card">
                        <h3 id="totalPoints">0</h3>
                        <p>‚≠ê Puntos</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="streak">0</h3>
                        <p>üî• Racha</p>
                    </div>
                    <div class="stat-card">
                        <h3 id="achievements">0</h3>
                        <p>üèÜ Logros</p>
                    </div>
                </div>
            </div>

            <div class="tab-navigation">
                <div class="nav-tab active" data-tab="calendar" onclick="showTab('calendar')">üìÖ Calendario</div>
                <div class="nav-tab" data-tab="stats" onclick="showTab('stats')">üìä Estad√≠sticas</div>
                <div class="nav-tab" data-tab="achievements" onclick="showTab('achievements')">üèÜ Logros</div>
                <div class="nav-tab" data-tab="ranking" onclick="showTab('ranking')">ü•á Ranking</div>
                <div class="nav-tab" data-tab="settings" onclick="showTab('settings')">‚öôÔ∏è Ajustes</div>
            </div>

            <div id="calendarTab" class="tab-content active">
                <div class="calendar-wrapper">
                    <div class="calendar-header">
                        <h2>üóìÔ∏è Tu Calendario de Aventuras</h2>
                        <p style="font-size: 18px; font-weight: 600; color: #636e72;">¬°30 minutos geniales cada d√≠a! üåü</p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #e3f2fd, #bbdefb); padding: 20px; border-radius: 20px; margin-bottom: 25px; border: 3px solid #2196f3;">
                        <h4 style="font-family: 'Fredoka One', cursive; font-size: 18px; color: #0d47a1; margin-bottom: 15px; text-align: center;">üìã Leyenda del Calendario</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; font-weight: 700; font-size: 15px;">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 24px;">üéØ</span>
                                <span style="color: #1565c0;">Hoy - ¬°A jugar!</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 24px;">üìù</span>
                                <span style="color: #1565c0;">Recuperar d√≠a perdido</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 24px;">‚úÖ</span>
                                <span style="color: #1565c0;">¬°Completado!</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 24px;">üîí</span>
                                <span style="color: #1565c0;">Bloqueado (futuro)</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="weeksContainer"></div>
                </div>
            </div>

            <div id="statsTab" class="tab-content">
                <div class="settings-container">
                    <div class="calendar-header">
                        <h2>üìä Mis Estad√≠sticas S√∫per Geniales</h2>
                    </div>
                    <div id="statsContent"></div>
                </div>
            </div>

            <div id="achievementsTab" class="tab-content">
                <div class="settings-container">
                    <div class="calendar-header">
                        <h2>üèÜ Mis Logros Incre√≠bles</h2>
                    </div>
                    <div id="achievementGrid" class="achievement-grid"></div>
                </div>
            </div>

            <div id="rankingTab" class="tab-content">
                <div class="ranking-container">
                    <div class="ranking-header">
                        <h2>ü•á Ranking de S√∫per Campeones</h2>
                    </div>
                    <div class="ranking-filters">
                        <button class="filter-btn active" onclick="setRankingFilter('all')">üåü Todos</button>
                        <button class="filter-btn" onclick="setRankingFilter('week')">üìÖ Esta Semana</button>
                        <button class="filter-btn" onclick="setRankingFilter('month')">üìÜ Este Mes</button>
                    </div>
                    <div id="podiumContainer" class="podium"></div>
                    <div id="rankingTableContainer" class="ranking-table"></div>
                </div>
            </div>

            <div id="settingsTab" class="tab-content">
                <div class="settings-container">
                    <div class="calendar-header">
                        <h2>‚öôÔ∏è Configuraci√≥n</h2>
                    </div>
                    
                    <div class="settings-section">
                        <h3>üîå Conexi√≥n</h3>
                        <button class="settings-btn success" onclick="testConnection()">üîÑ Probar Conexi√≥n</button>
                    </div>
                    
                    <div class="settings-section">
                        <h3>üíæ Datos</h3>
                        <button class="settings-btn" onclick="exportData()">üì• Exportar Mis Datos</button>
                        <button class="settings-btn danger" onclick="resetProgress()">üîÑ Reiniciar Progreso</button>
                    </div>
                    
                    <div class="settings-section">
                        <h3>‚ö†Ô∏è Zona Peligrosa</h3>
                        <button class="settings-btn danger" onclick="deleteUser()">üóëÔ∏è Eliminar Usuario Completo</button>
                        <p style="font-size: 14px; color: #d63031; font-weight: 600; margin-top: 10px;">‚ö†Ô∏è Esta acci√≥n borrar√° PERMANENTEMENTE tu usuario y todos tus datos del servidor.</p>
                    </div>
                    
                    <div class="settings-section">
                        <h3>‚ÑπÔ∏è Informaci√≥n</h3>
                        <p style="font-weight: 600; color: #636e72; margin: 10px 0;">Versi√≥n: 1.0</p>
                        <p style="font-weight: 600; color: #636e72; margin: 10px 0;">Usuario actual: <span id="currentUserDisplay"></span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="exercise-modal" id="exerciseModal">
        <div class="exercise-content">
            <button class="close-modal" onclick="closeExerciseModal()">‚úï</button>
            <div class="exercise-header">
                <h3 id="exerciseTitle">Ejercicios S√∫per Geniales</h3>
                <div id="subjectBadges"></div>
                <div class="timer-display" id="timerDisplay">‚è±Ô∏è Tiempo: 30:00</div>
            </div>
            
            <div class="progress-indicator" id="progressIndicator"></div>
            
            <div id="exerciseContainer"></div>
            
            <div class="hint-box" id="hintBox">
                <div style="font-size: 24px; margin-bottom: 10px;">üí° Pista Genial</div>
                <div class="hint-text" id="hintText"></div>
            </div>
            
            <div class="feedback-box" id="feedbackBox">
                <div id="feedbackText"></div>
            </div>

            <div class="explanation-box" id="explanationBox">
                <h4>üìö ¬øPor qu√© es as√≠?</h4>
                <div id="explanationText"></div>
            </div>
            
            <div class="exercise-buttons">
                <button class="exercise-btn secondary" id="hintBtn" onclick="showHint()">üí° Pista</button>
                <button class="exercise-btn primary" id="checkBtn" onclick="checkAnswer()">‚úì Comprobar</button>
                <button class="exercise-btn success" id="nextBtn" onclick="nextExercise()" style="display: none;">‚ûú Siguiente</button>
            </div>
        </div>
    </div>

    <div class="achievement-unlock" id="achievementUnlock">
        <div class="achievement-icon-big" id="unlockedIcon">üèÜ</div>
        <h3 id="unlockedName">¬°S√∫per Logro!</h3>
        <p id="unlockedDescription">¬°Has desbloqueado algo genial!</p>
        <button class="exercise-btn success" onclick="closeAchievementUnlock()" style="margin-top: 30px; width: 100%;">¬°Genial! üéâ</button>
    </div>

    <script>
        // ========================================
        // üîê CONTROL DE ACCESO CON CONTRASE√ëAS
        // ========================================
        // INSTRUCCIONES:
        // 1. Cada usuario tiene su propia contrase√±a
        // 2. Formato: "nombre_usuario": "su_contrase√±a"
        // 3. Los nombres NO distinguen may√∫sculas
        // 4. Las contrase√±as S√ç distinguen may√∫sculas
        
        const USUARIOS_CON_CONTRASE√ëA = {
            // Formato: "nombre": "contrase√±a"
            "Carlos": "1234",
            "Eren": "1234",
            "Mateo Devis": "1234",
            "Joel": "1234",
            
            // Agrega m√°s usuarios y contrase√±as aqu√≠...
        };
        
        // Funci√≥n para verificar usuario y contrase√±a
        function verificarCredenciales(username, password) {
            const nombreNormalizado = username.trim().toLowerCase();
            
            // Buscar el usuario en el objeto
            for (let usuario in USUARIOS_CON_CONTRASE√ëA) {
                if (usuario.toLowerCase() === nombreNormalizado) {
                    // Usuario encontrado, verificar contrase√±a
                    return USUARIOS_CON_CONTRASE√ëA[usuario] === password;
                }
            }
            
            return false; // Usuario no encontrado
        }
        
        // ========================================
        // CONFIGURACI√ìN DE JSONBIN (NUBE)
        // ========================================
        const JSONBIN_CONFIG = {
            binId: '68ee144343b1c97be96704f9',
            masterKey: '$2a$10$byEkgCiPtr6uA9j.sw5Uiuld00jGPRMT1Rn9TlhHYbPe3CFfaEu6G',
            apiUrl: 'https://api.jsonbin.io/v3'
        };

        let appState = {
            currentUser: null,
            userData: null,
            allUsersData: {},
            currentDay: null,
            currentExerciseIndex: 0,
            currentExercises: [],
            selectedAnswer: null,
            currentRankingFilter: 'all',
            sessionStartTime: null,
            timerInterval: null,
            timeRemaining: 1800
        };

        // BANCO DE EJERCICIOS CON TEXTOS LARGOS DE COMPRENSI√ìN LECTORA
        const exerciseBank = {
                    "math": [
                                {
                                            "instruction": "üéÆ Pikachu necesita tu ayuda con las matem√°ticas. Lee con atenci√≥n y calcula:",
                                            "question": "Pikachu ha derrotado a 234 Pokemon en batallas. Charizard ha derrotado el doble que Pikachu. ¬øCu√°ntos Pokemon ha derrotado Charizard?",
                                            "options": [
                                                        "468 Pokemon",
                                                        "334 Pokemon",
                                                        "464 Pokemon",
                                                        "234 Pokemon"
                                            ],
                                            "correct": 0,
                                            "hint": "El doble significa multiplicar por 2. Puedes sumar 234 + 234 para encontrar la respuesta.",
                                            "explanation": "Cuando decimos 'el doble', significa multiplicar por 2. Entonces: 234 √ó 2 = 468. ¬°Charizard es s√∫per fuerte! üî•"
                                },
                                {
                                            "instruction": "‚öΩ ¬°Problema de f√∫tbol! Vamos a resolver este ejercicio sobre el Real Madrid:",
                                            "question": "En el Bernab√©u caben 81.044 personas. Si ya hay 56.789 espectadores viendo el partido, ¬øcu√°ntas personas m√°s pueden entrar?",
                                            "options": [
                                                        "24.255 personas",
                                                        "25.255 personas",
                                                        "24.155 personas",
                                                        "23.255 personas"
                                            ],
                                            "correct": 0,
                                            "hint": "Tienes que restar: lo que cabe menos lo que ya hay.",
                                            "explanation": "Para saber cu√°ntas personas m√°s pueden entrar, restamos: 81.044 - 56.789 = 24.255. ‚öΩ‚ú®"
                                },
                                {
                                            "instruction": "‚öîÔ∏è ¬°Eren necesita calcular recursos para proteger la muralla!",
                                            "question": "Los Titanes atacan en grupos de 8. Si Eren cuenta 96 Titanes acerc√°ndose a la muralla Mar√≠a, ¬øcu√°ntos grupos son?",
                                            "options": [
                                                        "12 grupos",
                                                        "11 grupos",
                                                        "13 grupos",
                                                        "10 grupos"
                                            ],
                                            "correct": 0,
                                            "hint": "Divide el total de Titanes entre el tama√±o de cada grupo. Puedes usar la tabla del 8.",
                                            "explanation": "Para saber cu√°ntos grupos hay, dividimos: 96 √∑ 8 = 12 grupos. ¬°El Cuerpo de Exploraci√≥n debe estar preparado! ‚öîÔ∏è"
                                },
                                {
                                            "instruction": "‚öΩ ¬°Problema con las medallas del Barcelona!",
                                            "question": "El Bar√ßa tiene 3 vitrinas de trofeos. Cada vitrina contiene 25 medallas. ¬øCu√°ntas medallas tienen en total en el Camp Nou?",
                                            "options": [
                                                        "75 medallas",
                                                        "70 medallas",
                                                        "80 medallas",
                                                        "65 medallas"
                                            ],
                                            "correct": 0,
                                            "hint": "Multiplica el n√∫mero de vitrinas por las medallas en cada una. 25 √ó 3 = ?",
                                            "explanation": "Multiplicamos: 3 vitrinas √ó 25 medallas = 75 medallas. ¬°El Bar√ßa es uno de los equipos m√°s ganadores! üèÜ"
                                },
                                {
                                            "instruction": "üéÆ ¬°Ash est√° organizando sus Pokeballs! Vamos a ayudarlo:",
                                            "question": "Ash tiene 1/4 de sus Pokeballs con Pokemon de tipo Agua. Si tiene 20 Pokeballs en total, ¬øcu√°ntas tienen Pokemon de Agua como Squirtle?",
                                            "options": [
                                                        "5 Pokeballs",
                                                        "10 Pokeballs",
                                                        "4 Pokeballs",
                                                        "8 Pokeballs"
                                            ],
                                            "correct": 0,
                                            "hint": "1/4 significa dividir en 4 partes iguales y tomar 1. Divide 20 √∑ 4.",
                                            "explanation": "Una fracci√≥n 1/4 significa dividir algo en 4 partes iguales. 20 √∑ 4 = 5 Pokeballs con Pokemon de Agua. üíß"
                                },
                                {
                                            "instruction": "‚öΩ ¬°Cristiano Ronaldo est√° contabilizando su r√©cord hist√≥rico!",
                                            "question": "Cristiano ha marcado 567 goles en su carrera. En las siguientes temporadas marca 345 goles m√°s. ¬øCu√°ntos goles lleva en total?",
                                            "options": [
                                                        "912 goles",
                                                        "902 goles",
                                                        "812 goles",
                                                        "922 goles"
                                            ],
                                            "correct": 0,
                                            "hint": "Suma los goles: 567 + 345.",
                                            "explanation": "Sumamos: 567 + 345 = 912 goles. ¬°Cristiano es uno de los m√°ximos goleadores de la historia! ‚öΩüëë"
                                },
                                {
                                            "instruction": "üçú ¬°Naruto necesita comprar ramen para todo el equipo! Ay√∫dalo con esta cuenta:",
                                            "question": "Un taz√≥n de ramen de Ichiraku cuesta 8 euros. Si Naruto compra 7 tazones para Sakura, Sasuke, Kakashi y otros, ¬øcu√°nto dinero necesita?",
                                            "options": [
                                                        "56 euros",
                                                        "48 euros",
                                                        "64 euros",
                                                        "52 euros"
                                            ],
                                            "correct": 0,
                                            "hint": "Multiplica el precio de un taz√≥n por la cantidad: 8 √ó 7 = ?",
                                            "explanation": "Multiplicamos: 8 √ó 7 = 56 euros. ¬°El ramen de Ichiraku es el favorito de Naruto! üçú"
                                },
                                {
                                            "instruction": "‚öΩ ¬°Problema de puntos en La Liga! Vamos a calcular:",
                                            "question": "El Atl√©tico de Madrid gan√≥ 18 partidos (3 puntos cada victoria) y empat√≥ 6 partidos (1 punto cada empate). ¬øCu√°ntos puntos tiene en total?",
                                            "options": [
                                                        "60 puntos",
                                                        "54 puntos",
                                                        "66 puntos",
                                                        "72 puntos"
                                            ],
                                            "correct": 0,
                                            "hint": "Calcula primero los puntos por victorias (18 √ó 3) y luego s√∫male los puntos por empates (6 √ó 1).",
                                            "explanation": "Victorias: 18 √ó 3 = 54 puntos. Empates: 6 √ó 1 = 6 puntos. Total: 54 + 6 = 60 puntos. ‚öΩüìä"
                                },
                                {
                                            "instruction": "üéÆ ¬°Los Pokemon est√°n organizando el torneo de la Liga √çndigo!",
                                            "question": "Hay 144 Pokemon inscritos y deben formar equipos de 12 Pokemon cada uno. ¬øCu√°ntos equipos se pueden formar?",
                                            "options": [
                                                        "12 equipos",
                                                        "10 equipos",
                                                        "14 equipos",
                                                        "16 equipos"
                                            ],
                                            "correct": 0,
                                            "hint": "Divide el total entre el tama√±o de cada equipo: 144 √∑ 12 = ?",
                                            "explanation": "Dividimos: 144 √∑ 12 = 12 equipos. ¬°Perfecto para el torneo de la Liga Pokemon! üèÜ"
                                },
                                {
                                            "instruction": "üí® ¬°Sonic the Hedgehog est√° midiendo su velocidad!",
                                            "question": "Sonic recorre 450 kil√≥metros en 3 horas corriendo por Green Hill Zone. ¬øCu√°ntos kil√≥metros recorre en promedio cada hora?",
                                            "options": [
                                                        "150 km/h",
                                                        "140 km/h",
                                                        "160 km/h",
                                                        "135 km/h"
                                            ],
                                            "correct": 0,
                                            "hint": "Divide la distancia total entre las horas: 450 √∑ 3 = ?",
                                            "explanation": "Para calcular el promedio por hora: 450 √∑ 3 = 150 km/h. ¬°Sonic es s√∫per r√°pido! üí®üíô"
                                },
                                {
                                            "instruction": "üè¥‚Äç‚ò†Ô∏è ¬°Luffy est√° contando el tesoro que encontr√≥!",
                                            "question": "Luffy tiene 3 cofres con 125 monedas de oro cada uno y 2 cofres con 150 monedas cada uno. ¬øCu√°ntas monedas tiene en total el Going Merry?",
                                            "options": [
                                                        "675 monedas",
                                                        "625 monedas",
                                                        "725 monedas",
                                                        "575 monedas"
                                            ],
                                            "correct": 0,
                                            "hint": "Calcula (3 √ó 125) + (2 √ó 150). Haz cada multiplicaci√≥n primero y luego suma.",
                                            "explanation": "Primero: 3 √ó 125 = 375. Luego: 2 √ó 150 = 300. Total: 375 + 300 = 675 monedas. ¬°Luffy es rico! üí∞"
                                },
                                {
                                            "instruction": "‚öΩ ¬°C√°lculo de asistencias! Vamos a comparar a dos cracks:",
                                            "question": "Messi ha dado 89 asistencias en esta temporada. Neymar ha dado 2/3 de las asistencias que dio Messi. ¬øCu√°ntas asistencias dio Neymar?",
                                            "options": [
                                                        "59 asistencias",
                                                        "60 asistencias",
                                                        "45 asistencias",
                                                        "66 asistencias"
                                            ],
                                            "correct": 0,
                                            "hint": "Multiplica 89 √ó 2, luego divide entre 3.",
                                            "explanation": "Calculamos 2/3 de 89: (89 √ó 2) √∑ 3 = 178 √∑ 3 = 59 asistencias. ¬°Ambos son genios del f√∫tbol! ‚öΩ‚ú®"
                                },
                                {
                                            "instruction": "üéÆ ¬°Problema de evoluci√≥n Pokemon! Bulbasaur est√° creciendo:",
                                            "question": "Bulbasaur pesa 6.9 kg. Cuando evoluciona a Ivysaur, su peso aumenta 13.1 kg. ¬øCu√°nto pesa Ivysaur?",
                                            "options": [
                                                        "20 kg",
                                                        "19 kg",
                                                        "21 kg",
                                                        "18 kg"
                                            ],
                                            "correct": 0,
                                            "hint": "Suma el peso original m√°s el aumento: 6.9 + 13.1 = ?",
                                            "explanation": "Sumamos: 6.9 + 13.1 = 20 kg. ¬°Ivysaur es m√°s grande y pesado que Bulbasaur! üåø"
                                },
                                {
                                            "instruction": "‚öΩ ¬°Problema del estadio Camp Nou!",
                                            "question": "El Camp Nou tiene capacidad para 99.354 personas. Si 87.642 asientos ya est√°n ocupados para ver al Bar√ßa, ¬øcu√°ntos asientos quedan libres?",
                                            "options": [
                                                        "11.712 asientos",
                                                        "12.712 asientos",
                                                        "11.612 asientos",
                                                        "10.712 asientos"
                                            ],
                                            "correct": 0,
                                            "hint": "Resta: 99.354 - 87.642.",
                                            "explanation": "Restamos: 99.354 - 87.642 = 11.712 asientos libres. ¬°Todav√≠a pueden entrar muchos cul√©s! üèüÔ∏è"
                                },
                                {
                                            "instruction": "üçÑ ¬°Mario Bros est√° recolectando monedas en el Reino Champi√±√≥n!",
                                            "question": "Mario recoge 45 monedas por cada nivel que completa. Si completa 8 niveles, ¬øcu√°ntas monedas recolect√≥ en total?",
                                            "options": [
                                                        "360 monedas",
                                                        "350 monedas",
                                                        "405 monedas",
                                                        "320 monedas"
                                            ],
                                            "correct": 0,
                                            "hint": "Multiplica: 45 √ó 8.",
                                            "explanation": "Multiplicamos: 45 √ó 8 = 360 monedas. ¬°Mario puede comprar muchas vidas extra! üçÑ‚ú®"
                                },
                                {
                                            "instruction": "‚öΩ ¬°Mbapp√© del PSG est√° calculando su velocidad en un sprint!",
                                            "question": "Mbapp√© corri√≥ 720 metros en 60 segundos durante un entrenamiento. ¬øCu√°ntos metros recorre por segundo?",
                                            "options": [
                                                        "12 m/s",
                                                        "10 m/s",
                                                        "14 m/s",
                                                        "11 m/s"
                                            ],
                                            "correct": 0,
                                            "hint": "Divide la distancia entre el tiempo: 720 √∑ 60 = ?",
                                            "explanation": "Dividimos: 720 √∑ 60 = 12 metros por segundo. ¬°Mbapp√© es veloc√≠simo! ‚ö°‚öΩ"
                                },
                                {
                                            "instruction": "üêâ ¬°Goku est√° entrenando con el Maestro Roshi!",
                                            "question": "Goku levanta 250 kg con cada brazo durante su entrenamiento. ¬øCu√°ntos kilogramos levanta en total con ambos brazos?",
                                            "options": [
                                                        "500 kg",
                                                        "450 kg",
                                                        "550 kg",
                                                        "400 kg"
                                            ],
                                            "correct": 0,
                                            "hint": "Suma lo que levanta con cada brazo: 250 + 250 = ?",
                                            "explanation": "Sumamos: 250 + 250 = 500 kg en total. ¬°Goku es incre√≠blemente fuerte gracias a su entrenamiento! üí™"
                                },
                                {
                                            "instruction": "‚öΩ ¬°Problema matem√°tico de la Copa del Mundo!",
                                            "question": "En un mundial se juegan 64 partidos en total. Si cada partido dura 90 minutos, ¬øcu√°ntos minutos de f√∫tbol hay en toda la Copa del Mundo?",
                                            "options": [
                                                        "5.760 minutos",
                                                        "5.660 minutos",
                                                        "5.860 minutos",
                                                        "6.000 minutos"
                                            ],
                                            "correct": 0,
                                            "hint": "Multiplica: 64 √ó 90.",
                                            "explanation": "Multiplicamos: 64 √ó 90 = 5.760 minutos. ¬°Eso es much√≠simo f√∫tbol para disfrutar! ‚öΩüåç"
                                }
                    ],
                    "reading": [
                                {
                                            "instruction": "üìñ Lee este texto sobre la aventura de Pikachu en el bosque:",
                                            "passageTitle": "La Gran Aventura de Pikachu en el Bosque Verde",
                                            "passage": "Era un d√≠a soleado cuando Pikachu decidi√≥ explorar el Bosque Verde. Ash le advirti√≥: 'Ten cuidado, Pikachu. En el bosque viven Pokemon salvajes muy poderosos.'\n\nPikachu camin√≥ durante una hora hasta que escuch√≥ un ruido extra√±o. Sus mejillas el√©ctricas brillaron, listo para defenderse. De repente, apareci√≥ un peque√±o Caterpie asustado.\n\nEl Caterpie explic√≥ que se hab√≠a perdido buscando hojas de mora para comer. Pikachu decidi√≥ ayudarlo. Juntos caminaron dos horas hasta encontrar un √°rbol enorme lleno de hojas verdes.\n\nMientras Caterpie com√≠a feliz, Pikachu escuch√≥ un grito lejano. ¬°Era Ash! Pikachu se despidi√≥ de su nuevo amigo y corri√≥ hacia la voz de Ash.",
                                            "question": "¬øCu√°nto tiempo camin√≥ Pikachu en total durante su aventura? (cuenta el inicio + ayuda a Caterpie)",
                                            "options": [
                                                        "3 horas",
                                                        "1 hora",
                                                        "2 horas",
                                                        "4 horas"
                                            ],
                                            "correct": 0,
                                            "hint": "1 hora al principio + 2 horas ayudando a Caterpie = ?",
                                            "explanation": "Pikachu camin√≥ 1 hora al principio y luego 2 horas m√°s ayudando a Caterpie. Total: 1 + 2 = 3 horas. ‚ö°"
                                },
                                {
                                            "instruction": "üìñ Lee sobre la historia del Real Madrid:",
                                            "passageTitle": "El Real Madrid: El Gigante del F√∫tbol",
                                            "passage": "El Real Madrid fue fundado en 1902. En 1920 el Rey Alfonso XIII le dio el t√≠tulo de 'Real', que significa 'del Rey'.\n\nEl estadio se llama Santiago Bernab√©u, construido en 1947. Tiene capacidad para m√°s de 81.000 espectadores y es uno de los m√°s famosos del mundo.\n\nEl equipo ha ganado 14 Champions League, m√°s que ning√∫n otro equipo. Algunos jugadores legendarios: Alfredo Di St√©fano marc√≥ 308 goles; Cristiano Ronaldo marc√≥ incre√≠bles 450 goles entre 2009 y 2018.\n\nEl Real Madrid tiene una rivalidad hist√≥rica con el FC Barcelona. Su partido se llama 'El Cl√°sico' y lo ven m√°s de 500 millones de personas en todo el mundo.",
                                            "question": "Seg√∫n el texto, ¬øcu√°ntos goles marc√≥ Cristiano Ronaldo en el Real Madrid?",
                                            "options": [
                                                        "450 goles",
                                                        "308 goles",
                                                        "500 goles",
                                                        "81 goles"
                                            ],
                                            "correct": 0,
                                            "hint": "Busca en el tercer p√°rrafo donde habla de Cristiano Ronaldo.",
                                            "explanation": "El texto dice: 'Cristiano Ronaldo marc√≥ incre√≠bles 450 goles entre 2009 y 2018'. ‚öΩüëë"
                                },
                                {
                                            "instruction": "üìñ Lee esta historia √©pica de Ataque a los Titanes:",
                                            "passageTitle": "El D√≠a que Cay√≥ el Muro Mar√≠a",
                                            "passage": "Eren Yeager ten√≠a 10 a√±os cuando viv√≠a tranquilo en Shiganshina, protegido por tres murallas gigantes: Mar√≠a (exterior), Rose (media) y Sina (interior). Las murallas de 50 metros de altura hab√≠an protegido a la humanidad durante 100 a√±os.\n\nEren viv√≠a con su padre Grisha (m√©dico), su madre Carla, y su hermana adoptiva Mikasa. Su amigo Armin le mostraba libros secretos sobre el oc√©ano y las monta√±as m√°s all√° de las murallas.\n\nUn d√≠a terrible apareci√≥ el Tit√°n Colosal de 60 metros, m√°s alto que las murallas. Con una patada, destruy√≥ la puerta del Muro Mar√≠a. Los titanes entraron y Eren vio c√≥mo atacaban a su madre.\n\nEsa tragedia cambi√≥ a Eren para siempre. Jur√≥ vengarse y unirse al Cuerpo de Exploraci√≥n. Mikasa y Armin decidieron acompa√±arlo.\n\nDespu√©s de tres a√±os de entrenamiento militar, se graduaron. Eren qued√≥ en el puesto 5, Mikasa fue la n√∫mero 1 por su incre√≠ble fuerza, y Armin era el m√°s inteligente de todos.",
                                            "question": "¬øEn qu√© puesto qued√≥ Eren en su graduaci√≥n del entrenamiento militar?",
                                            "options": [
                                                        "Puesto 5",
                                                        "Puesto 1",
                                                        "Puesto 10",
                                                        "Puesto 3"
                                            ],
                                            "correct": 0,
                                            "hint": "Busca en el √∫ltimo p√°rrafo donde habla de la graduaci√≥n.",
                                            "explanation": "El texto dice: 'Eren qued√≥ en el puesto n√∫mero 5'. ¬°Mikasa fue la mejor! ‚öîÔ∏è"
                                },
                                {
                                            "instruction": "üìù Gram√°tica Pokemon - Identifica el VERBO:",
                                            "question": "En la frase: 'Los Pokemon luchan valientemente en el gimnasio de Ciudad Plateada' - ¬øCu√°l es el VERBO?",
                                            "options": [
                                                        "luchan",
                                                        "Pokemon",
                                                        "gimnasio",
                                                        "valientemente"
                                            ],
                                            "correct": 0,
                                            "hint": "El verbo indica la ACCI√ìN que realizan los Pokemon. ¬øQu√© est√°n haciendo?",
                                            "explanation": "El verbo es 'luchan' porque indica la acci√≥n que realizan los Pokemon. Los verbos expresan acciones. üí™"
                                },
                                {
                                            "instruction": "üìù ¬°Ortograf√≠a futbolera! Messi en acci√≥n:",
                                            "question": "¬øC√≥mo se escribe correctamente esta frase sobre el partido?",
                                            "options": [
                                                        "Messi jug√≥ un partido incre√≠ble",
                                                        "Mesi jugo un partido increible",
                                                        "Messi jugo un partido incre√≠ble",
                                                        "Mesi jug√≥ un partido increible"
                                            ],
                                            "correct": 0,
                                            "hint": "'Messi' lleva dos 's', 'jug√≥' lleva tilde, 'incre√≠ble' tambi√©n lleva tilde.",
                                            "explanation": "'Messi' se escribe con doble 's', 'jug√≥' con tilde, 'incre√≠ble' con tilde. ‚öΩüìù"
                                },
                                {
                                            "instruction": "üìñ Lee sobre el ninja que nunca se rinde:",
                                            "passageTitle": "Naruto Uzumaki y su Camino Ninja",
                                            "passage": "Naruto Uzumaki sue√±a con convertirse en Hokage, el ninja m√°s fuerte de la Aldea Oculta de la Hoja. Cuando era peque√±o, todos lo rechazaban porque dentro de √©l estaba sellado el Zorro de Nueve Colas, Kurama.\n\nSu primer maestro fue Iruka-sensei, quien crey√≥ en √©l. Luego fue asignado al Equipo 7 junto con Sasuke Uchiha, Sakura Haruno, y su maestro Kakashi Hatake.\n\nEl jutsu favorito de Naruto es el Rasengan, una esfera de chakra rotatorio que le ense√±√≥ el legendario Jiraiya, uno de los Tres Sannin.\n\nLa frase que Naruto repite constantemente es: '¬°Nunca me rindo! Ese es mi camino ninja, dattebayo!'",
                                            "question": "¬øQui√©n le ense√±√≥ a Naruto el poderoso jutsu Rasengan?",
                                            "options": [
                                                        "Jiraiya",
                                                        "Kakashi",
                                                        "Iruka",
                                                        "Sasuke"
                                            ],
                                            "correct": 0,
                                            "hint": "Busca en el tercer p√°rrafo. Es uno de los Tres Sannin legendarios.",
                                            "explanation": "El texto dice que le ense√±√≥ 'el legendario Jiraiya, uno de los Tres Sannin'. ¬°Dattebayo! üçú"
                                },
                                {
                                            "instruction": "üìù Identificar el SUJETO en f√∫tbol:",
                                            "question": "En la oraci√≥n: 'El Real Madrid gan√≥ la Champions League en Par√≠s' - ¬øCu√°l es el SUJETO?",
                                            "options": [
                                                        "El Real Madrid",
                                                        "gan√≥",
                                                        "la Champions League",
                                                        "Madrid"
                                            ],
                                            "correct": 0,
                                            "hint": "El sujeto es QUI√âN realiza la acci√≥n. ¬øQui√©n gan√≥?",
                                            "explanation": "El sujeto es 'El Real Madrid' porque es quien realiza la acci√≥n de ganar. ‚öΩüèÜ"
                                },
                                {
                                            "instruction": "üìñ Lee sobre Link y su misi√≥n en Hyrule:",
                                            "passageTitle": "La Leyenda de Zelda: La Aventura de Link",
                                            "passage": "Link es un valiente h√©roe que debe rescatar a la Princesa Zelda del malvado Ganondorf. Para lograrlo, debe conseguir tres objetos sagrados: la Master Sword (Espada Maestra), el Escudo de Hyrule, y la Ocarina del Tiempo.\n\nEn su aventura, Link explora mazmorras llenas de enemigos y puzzles. Su compa√±era fiel es Navi, un hada peque√±a de luz azul brillante que le da consejos √∫tiles y le dice '¬°Hey! ¬°Escucha!' cuando hay algo importante.\n\nLink tambi√©n tiene un caballo llamado Epona, que corre muy r√°pido y lo ayuda a viajar por el vasto reino de Hyrule.",
                                            "question": "¬øDe qu√© color es la luz de Navi, el hada compa√±era de Link?",
                                            "options": [
                                                        "Azul",
                                                        "Verde",
                                                        "Amarilla",
                                                        "Roja"
                                            ],
                                            "correct": 0,
                                            "hint": "Revisa el segundo p√°rrafo donde describe a Navi detalladamente.",
                                            "explanation": "El texto dice: 'un hada peque√±a de luz azul brillante'. ¬°Hey! ¬°Escucha! üßö‚Äç‚ôÄÔ∏è"
                                },
                                {
                                            "instruction": "üìù Reconocer tipos de palabras con Pokemon:",
                                            "question": "En 'Pikachu r√°pidamente atac√≥ con impactrueno', la palabra 'r√°pidamente' es:",
                                            "options": [
                                                        "Un adverbio (dice C√ìMO atac√≥)",
                                                        "Un verbo (acci√≥n)",
                                                        "Un sustantivo (nombre)",
                                                        "Un adjetivo"
                                            ],
                                            "correct": 0,
                                            "hint": "Termina en '-mente' y nos dice C√ìMO Pikachu hizo la acci√≥n.",
                                            "explanation": "'R√°pidamente' es un adverbio que nos dice C√ìMO Pikachu realiz√≥ el ataque. ‚ö°"
                                },
                                {
                                            "instruction": "üìñ Lee sobre los hermanos fontaneros del Reino Champi√±√≥n:",
                                            "passageTitle": "Mario y Luigi: Los S√∫per Hermanos",
                                            "passage": "Mario y Luigi son hermanos fontaneros que viven en el Reino Champi√±√≥n. Mario siempre viste su ic√≥nico overol rojo y azul, mientras que Luigi prefiere el verde y azul. Aunque Luigi es m√°s alto, Mario es m√°s conocido.\n\nSu misi√≥n principal es rescatar a la Princesa Peach del malvado Bowser, un drag√≥n tortuga gigante que constantemente la secuestra. Para lograrlo, deben atravesar 8 mundos diferentes, cada uno con sus propios desaf√≠os y enemigos.\n\nYoshi, un dinosaurio verde amigable, frecuentemente ayuda a Mario. Yoshi puede comer enemigos con su larga lengua y poner huevos, lo que lo hace muy √∫til en las aventuras.",
                                            "question": "¬øCu√°ntos mundos deben atravesar Mario y Luigi para rescatar a la Princesa Peach?",
                                            "options": [
                                                        "8 mundos",
                                                        "7 mundos",
                                                        "10 mundos",
                                                        "6 mundos"
                                            ],
                                            "correct": 0,
                                            "hint": "Busca en el segundo p√°rrafo el n√∫mero exacto de mundos.",
                                            "explanation": "El texto dice: 'deben atravesar 8 mundos diferentes'. ¬°Mamma mia! üçÑ"
                                },
                                {
                                            "instruction": "üìù Conjugaci√≥n de verbos en f√∫tbol:",
                                            "question": "¬øCu√°l es el PASADO del verbo 'jugar' en primera persona singular (YO)?",
                                            "options": [
                                                        "Yo jugu√©",
                                                        "Yo jugo",
                                                        "Yo jugar√©",
                                                        "Yo juego"
                                            ],
                                            "correct": 0,
                                            "hint": "El pasado indica algo que YA sucedi√≥. Busca la forma terminada en '-√©'.",
                                            "explanation": "'Jugu√©' es el pret√©rito perfecto simple (pasado) de 'jugar'. Ejemplo: Ayer yo jugu√© al f√∫tbol. ‚öΩ"
                                },
                                {
                                            "instruction": "üìñ Lee sobre Goku y las Esferas del Drag√≥n:",
                                            "passageTitle": "Dragon Ball: La B√∫squeda de las Esferas",
                                            "passage": "Goku es un Saiyan que lleg√≥ a la Tierra en una nave espacial cuando era beb√©. Fue criado por el bondadoso Maestro Gohan en las monta√±as. Su comida favorita es el arroz con pollo, y puede comer cantidades enormes.\n\nLas Esferas del Drag√≥n son 7 bolas m√°gicas naranjas con estrellas rojas dentro. Cuando alguien re√∫ne las 7 esferas, pueden invocar al drag√≥n Shenlong. Este drag√≥n m√≠stico puede conceder dos deseos a quien lo invoque.\n\nLos mejores amigos de Goku son Krillin (su compa√±ero de entrenamiento desde ni√±o) y Bulma (una genio cient√≠fica que fue quien lo conoci√≥ primero).",
                                            "question": "¬øCu√°ntos deseos puede conceder el drag√≥n Shenlong cuando es invocado?",
                                            "options": [
                                                        "Dos deseos",
                                                        "Un deseo",
                                                        "Tres deseos",
                                                        "Siete deseos"
                                            ],
                                            "correct": 0,
                                            "hint": "Busca en el segundo p√°rrafo donde habla del drag√≥n y sus poderes.",
                                            "explanation": "El texto dice: 'puede conceder dos deseos a quien lo invoque'. ¬°Kamehameha! üêâ"
                                },
                                {
                                            "instruction": "üìù Signos de puntuaci√≥n en espa√±ol:",
                                            "question": "¬øQu√© signo especial va al INICIO de una pregunta en espa√±ol?",
                                            "options": [
                                                        "¬ø (signo de interrogaci√≥n inicial)",
                                                        "! (signo de exclamaci√≥n)",
                                                        "? (signo de interrogaci√≥n final)",
                                                        ", (coma)"
                                            ],
                                            "correct": 0,
                                            "hint": "En espa√±ol, las preguntas tienen un signo especial al INICIO y otro al final.",
                                            "explanation": "En espa√±ol, las preguntas comienzan con '¬ø' y terminan con '?'. Esto es √∫nico del espa√±ol. üìù‚ùì"
                                },
                                {
                                            "instruction": "üìñ Lee sobre el erizo m√°s veloz del mundo:",
                                            "passageTitle": "Sonic: Velocidad Supers√≥nica",
                                            "passage": "Sonic es un erizo azul que puede correr a la velocidad del sonido. Su velocidad m√°xima registrada es de 1.200 kil√≥metros por hora. Cuando corre a toda velocidad, se enrolla en una bola y puede destruir los robots del Dr. Eggman.\n\nSu archienemigo es el Dr. Eggman (tambi√©n llamado Dr. Robotnik), un cient√≠fico malvado que quiere conquistar el mundo usando robots. Eggman tiene un bigote muy grande, es calvo y siempre usa gafas oscuras redondas.\n\nTails, cuyo nombre real es Miles Prower, es el mejor amigo de Sonic. Es un adorable zorro con dos colas que puede volar gir√°ndolas como las h√©lices de un helic√≥ptero.",
                                            "question": "¬øCu√°ntas colas tiene Tails, el mejor amigo de Sonic?",
                                            "options": [
                                                        "Dos colas",
                                                        "Una cola",
                                                        "Tres colas",
                                                        "Cuatro colas"
                                            ],
                                            "correct": 0,
                                            "hint": "Su nombre 'Tails' significa 'colas'. Lee el √∫ltimo p√°rrafo con atenci√≥n.",
                                            "explanation": "El texto dice: 'un adorable zorro con dos colas'. ¬°Por eso se llama Tails! üí®"
                                },
                                {
                                            "instruction": "üìù Sin√≥nimos - palabras con significado similar:",
                                            "question": "¬øCu√°l es un SIN√ìNIMO de la palabra 'valiente' (como los guerreros del Cuerpo de Exploraci√≥n)?",
                                            "options": [
                                                        "Corajudo",
                                                        "Miedoso",
                                                        "D√©bil",
                                                        "Triste"
                                            ],
                                            "correct": 0,
                                            "hint": "Un sin√≥nimo tiene significado parecido. Valiente es alguien que no tiene miedo.",
                                            "explanation": "'Corajudo' es sin√≥nimo de 'valiente'. Ambas palabras significan tener coraje y valent√≠a. ü¶Å"
                                },
                                {
                                            "instruction": "üìñ Lee sobre el mundo de bloques de Minecraft:",
                                            "passageTitle": "Minecraft: Construye Tu Mundo",
                                            "passage": "Minecraft es un juego donde puedes construir cualquier cosa usando bloques. Hay tres modos de juego: Supervivencia (debes conseguir recursos y defender tu vida), Creativo (tienes recursos infinitos), y Aventura (para jugar mapas especiales creados por otros).\n\nEn el modo Supervivencia, durante la noche aparecen monstruos peligrosos: Creepers verdes que explotan, Zombies que te persiguen, Esqueletos que disparan flechas, y Ara√±as gigantes que trepan paredes. Debes construir un refugio antes de que oscurezca.\n\nEl recurso m√°s valioso es el Diamante, de color azul brillante. Solo se encuentra en las profundidades de las cuevas, entre los niveles 5 y 12. Con diamantes puedes fabricar las herramientas m√°s fuertes y duraderas del juego.",
                                            "question": "¬øEntre qu√© niveles se encuentran los diamantes en Minecraft?",
                                            "options": [
                                                        "Entre niveles 5 y 12",
                                                        "Entre niveles 1 y 10",
                                                        "Entre niveles 10 y 20",
                                                        "Entre niveles 5 y 15"
                                            ],
                                            "correct": 0,
                                            "hint": "Busca en el √∫ltimo p√°rrafo donde habla espec√≠ficamente de los diamantes.",
                                            "explanation": "El texto dice: 'entre los niveles 5 y 12'. ¬°A minar diamantes! ‚õèÔ∏èüíé"
                                },
                                {
                                            "instruction": "üìù Ant√≥nimos - palabras con significado opuesto:",
                                            "question": "¬øCu√°l es un ANT√ìNIMO de la palabra 'r√°pido' (lo contrario de Sonic)?",
                                            "options": [
                                                        "Lento",
                                                        "Veloz",
                                                        "√Ågil",
                                                        "Ligero"
                                            ],
                                            "correct": 0,
                                            "hint": "Un ant√≥nimo es lo contrario. Si 'r√°pido' es tener velocidad, su opuesto ser√≠a...",
                                            "explanation": "'Lento' es ant√≥nimo de 'r√°pido'. Son palabras con significados opuestos. üê¢‚ö°"
                                },
                                {
                                            "instruction": "üìñ Lee sobre la batalla por la Victoria Real:",
                                            "passageTitle": "Fortnite: La Isla de la Batalla",
                                            "passage": "Fortnite es un juego de batalla donde 100 jugadores compiten en una isla. El objetivo es ser el √∫ltimo jugador o equipo en pie para ganar la codiciada Victoria Real. La partida comienza cuando todos saltan del autob√∫s volador Battle Bus.\n\nLo √∫nico de Fortnite es que puedes construir estructuras usando tres materiales: madera (la m√°s d√©bil pero r√°pida de construir), ladrillo (equilibrada en resistencia y velocidad), y metal (la m√°s fuerte pero lenta de construir). Estas construcciones te protegen de los enemigos.\n\nDurante la partida, una tormenta morada va reduciendo el √°rea de juego cada cierto tiempo. Si te quedas fuera de la zona segura, pierdes vida constantemente. Esto obliga a todos los jugadores a encontrarse eventualmente.",
                                            "question": "¬øCu√°l es el material M√ÅS FUERTE para construir en Fortnite?",
                                            "options": [
                                                        "Metal",
                                                        "Madera",
                                                        "Ladrillo",
                                                        "Piedra"
                                            ],
                                            "correct": 0,
                                            "hint": "Busca en el segundo p√°rrafo donde compara los tres materiales de construcci√≥n.",
                                            "explanation": "El texto dice: 'metal (la m√°s fuerte pero lenta de construir)'. El metal es el m√°s resistente. üî®"
                                }
                    ],
                    "science": [
                                {
                                            "instruction": "üî¨ ¬°Ciencia con Pokemon! Los estados de la materia:",
                                            "question": "Cuando Squirtle usa su ataque de Rayo Hielo y congela el agua, ¬øen qu√© estado est√° el agua congelada?",
                                            "options": [
                                                        "S√≥lido",
                                                        "L√≠quido",
                                                        "Gaseoso",
                                                        "Plasma"
                                            ],
                                            "correct": 0,
                                            "hint": "Cuando el agua se congela, se vuelve dura como una piedra. Los cubitos de hielo son...",
                                            "explanation": "El hielo es agua en estado S√ìLIDO. Cuando el agua se enfr√≠a a 0¬∞C o menos, se congela y se vuelve dura. ‚ùÑÔ∏è"
                                },
                                {
                                            "instruction": "üå± ¬°Ciencias Naturales! Bulbasaur y las plantas:",
                                            "question": "Bulbasaur es tipo Planta. ¬øQu√© necesitan las plantas como Bulbasaur para hacer la fotos√≠ntesis y crear energ√≠a?",
                                            "options": [
                                                        "Luz solar, agua y di√≥xido de carbono",
                                                        "Solo agua",
                                                        "Solo tierra",
                                                        "Solo aire"
                                            ],
                                            "correct": 0,
                                            "hint": "Las plantas usan: energ√≠a del sol, agua de la tierra, y un gas del aire.",
                                            "explanation": "Las plantas hacen fotos√≠ntesis usando: luz solar (energ√≠a), agua (del suelo), y di√≥xido de carbono (del aire). Producen su alimento y liberan ox√≠geno. üå≥‚òÄÔ∏è"
                                },
                                {
                                            "instruction": "‚ö° ¬°Electricidad con Pikachu! Aprende sobre energ√≠a:",
                                            "question": "¬øQu√© tipo de energ√≠a produce Pikachu cuando usa sus ataques de Impactrueno o Rayo?",
                                            "options": [
                                                        "Energ√≠a el√©ctrica",
                                                        "Energ√≠a t√©rmica",
                                                        "Energ√≠a nuclear",
                                                        "Energ√≠a qu√≠mica"
                                            ],
                                            "correct": 0,
                                            "hint": "Pikachu lanza rayos y truenos. Eso es electricidad pura.",
                                            "explanation": "Pikachu produce ENERG√çA EL√âCTRICA, que es el movimiento de electrones. ¬°Como los rayos en las tormentas! ‚ö°"
                                },
                                {
                                            "instruction": "üåç ¬°Astronom√≠a! Los planetas del sistema solar:",
                                            "question": "Si Goku viajara en su nave espacial, ¬øcu√°l es el planeta m√°s cercano al Sol que encontrar√≠a primero?",
                                            "options": [
                                                        "Mercurio",
                                                        "Venus",
                                                        "Tierra",
                                                        "Marte"
                                            ],
                                            "correct": 0,
                                            "hint": "Es el planeta m√°s peque√±o y el primero desde el Sol. Su nombre empieza con M.",
                                            "explanation": "MERCURIO es el planeta m√°s cercano al Sol, a unos 58 millones de kil√≥metros. Por estar tan cerca, es muy caliente durante el d√≠a. ‚òÄÔ∏èü™ê"
                                },
                                {
                                            "instruction": "ü¶¥ ¬°Sistema √≥seo humano! Como los Titanes, tenemos huesos:",
                                            "question": "¬øCu√°ntos huesos tiene aproximadamente un ser humano adulto? (¬°Menos que un Tit√°n gigante!)",
                                            "options": [
                                                        "206 huesos",
                                                        "150 huesos",
                                                        "300 huesos",
                                                        "100 huesos"
                                            ],
                                            "correct": 0,
                                            "hint": "Es un n√∫mero entre 200 y 210. Los beb√©s nacen con m√°s, pero algunos se fusionan al crecer.",
                                            "explanation": "Un adulto tiene aproximadamente 206 HUESOS. Los beb√©s nacen con unos 300, pero algunos se fusionan. ü¶¥"
                                },
                                {
                                            "instruction": "üíß ¬°El ciclo del agua! Como el ataque Hidrobomba de Blastoise:",
                                            "question": "¬øC√≥mo se llama el proceso cuando el agua l√≠quida se convierte en vapor (como cuando Charizard calienta el agua)?",
                                            "options": [
                                                        "Evaporaci√≥n",
                                                        "Condensaci√≥n",
                                                        "Precipitaci√≥n",
                                                        "Solidificaci√≥n"
                                            ],
                                            "correct": 0,
                                            "hint": "Es cuando el Sol calienta el agua de oc√©anos y r√≠os, y sube al cielo como vapor.",
                                            "explanation": "La EVAPORACI√ìN es cuando el agua l√≠quida se transforma en vapor por el calor del Sol. Luego forma las nubes. ‚òÅÔ∏èüíß"
                                },
                                {
                                            "instruction": "üîã ¬°Energ√≠as del futuro! Como el poder de las Esferas del Drag√≥n:",
                                            "question": "¬øCu√°l de estas es una energ√≠a renovable (que no se agota)?",
                                            "options": [
                                                        "Energ√≠a solar",
                                                        "Petr√≥leo",
                                                        "Carb√≥n",
                                                        "Gas natural"
                                            ],
                                            "correct": 0,
                                            "hint": "Renovable significa que no se agota. Piensa en algo que viene del Sol.",
                                            "explanation": "La ENERG√çA SOLAR es renovable porque el Sol brilla todos los d√≠as y durar√° millones de a√±os. ‚òÄÔ∏èüå±"
                                },
                                {
                                            "instruction": "üêõ ¬°Metamorfosis Pokemon! Caterpie, Metapod, Butterfree:",
                                            "question": "¬øEn qu√© orden ocurre la metamorfosis de una mariposa en la naturaleza (como Caterpie evoluciona)?",
                                            "options": [
                                                        "Huevo ‚Üí Oruga ‚Üí Cris√°lida ‚Üí Mariposa",
                                                        "Huevo ‚Üí Cris√°lida ‚Üí Oruga ‚Üí Mariposa",
                                                        "Oruga ‚Üí Huevo ‚Üí Mariposa ‚Üí Cris√°lida",
                                                        "Mariposa ‚Üí Huevo ‚Üí Oruga ‚Üí Cris√°lida"
                                            ],
                                            "correct": 0,
                                            "hint": "Primero nace del huevo como gusano, luego se envuelve en un capullo, y finalmente sale volando.",
                                            "explanation": "La metamorfosis correcta es: HUEVO (nace) ‚Üí ORUGA (come mucho) ‚Üí CRIS√ÅLIDA (se transforma dentro) ‚Üí MARIPOSA (¬°vuela!). ü¶ã"
                                },
                                {
                                            "instruction": "üå°Ô∏è ¬°Temperatura! Como cuando Articuno congela todo:",
                                            "question": "¬øA qu√© temperatura se congela el agua pura y se convierte en hielo?",
                                            "options": [
                                                        "0 grados Celsius",
                                                        "10 grados Celsius",
                                                        "100 grados Celsius",
                                                        "-10 grados Celsius"
                                            ],
                                            "correct": 0,
                                            "hint": "Es el punto donde el agua se convierte en hielo. Es un n√∫mero redondo muy f√°cil de recordar.",
                                            "explanation": "El agua pura se congela a 0¬∞C (cero grados Celsius). A 100¬∞C hierve y se evapora. ‚ùÑÔ∏èüå°Ô∏è"
                                },
                                {
                                            "instruction": "ü´Ä ¬°Sistema circulatorio! El coraz√≥n de un Saiyan late m√°s r√°pido:",
                                            "question": "¬øQu√© √≥rgano bombea la sangre por todo el cuerpo humano?",
                                            "options": [
                                                        "El coraz√≥n",
                                                        "El cerebro",
                                                        "Los pulmones",
                                                        "El est√≥mago"
                                            ],
                                            "correct": 0,
                                            "hint": "Es un √≥rgano que late constantemente en el pecho. Cuando Goku pelea, late m√°s r√°pido.",
                                            "explanation": "El CORAZ√ìN es el √≥rgano que bombea sangre. Late aproximadamente 100.000 veces al d√≠a. ¬°Es como una bomba s√∫per poderosa! ‚ù§Ô∏è"
                                },
                                {
                                            "instruction": "üåô ¬°Las fases de la Luna! Como en Zelda con la Luna que cae:",
                                            "question": "¬øCu√°nto tiempo tarda la Luna en dar una vuelta completa alrededor de la Tierra?",
                                            "options": [
                                                        "Aproximadamente 28 d√≠as",
                                                        "7 d√≠as",
                                                        "365 d√≠as",
                                                        "24 horas"
                                            ],
                                            "correct": 0,
                                            "hint": "Es casi un mes. Por eso cada semana la Luna se ve diferente en el cielo nocturno.",
                                            "explanation": "La Luna tarda aproximadamente 28 D√çAS (casi un mes) en orbitar la Tierra. Por eso vemos diferentes fases. üåô"
                                },
                                {
                                            "instruction": "‚öõÔ∏è ¬°Los √°tomos! M√°s peque√±os que una Pokeball minimizada:",
                                            "question": "¬øQu√© es m√°s peque√±o: un √°tomo o una mol√©cula?",
                                            "options": [
                                                        "Un √°tomo",
                                                        "Una mol√©cula",
                                                        "Son del mismo tama√±o",
                                                        "Una c√©lula"
                                            ],
                                            "correct": 0,
                                            "hint": "Las mol√©culas est√°n hechas de varios √°tomos unidos. ¬øQu√© ser√° m√°s peque√±o?",
                                            "explanation": "Un √ÅTOMO es m√°s peque√±o. Las mol√©culas son grupos de √°tomos unidos. Ejemplo: agua (H‚ÇÇO) = 2 √°tomos de hidr√≥geno + 1 de ox√≠geno. ‚öõÔ∏è"
                                },
                                {
                                            "instruction": "ü¶∑ ¬°Los dientes! Como los colmillos de Charizard:",
                                            "question": "¬øCu√°ntos dientes permanentes tiene un ser humano adulto?",
                                            "options": [
                                                        "32 dientes",
                                                        "20 dientes",
                                                        "28 dientes",
                                                        "40 dientes"
                                            ],
                                            "correct": 0,
                                            "hint": "Incluye las muelas del juicio. Si cuentas arriba y abajo, son bastantes.",
                                            "explanation": "Un adulto tiene 32 DIENTES PERMANENTES (incluyendo 4 muelas del juicio). ¬°Cep√≠llalos bien como Ash! ü¶∑‚ú®"
                                },
                                {
                                            "instruction": "üåà ¬°La luz y los colores! Como el arco√≠ris en el Mundo Champi√±√≥n:",
                                            "question": "¬øCu√°ntos colores tiene el arco√≠ris que aparece despu√©s de la lluvia?",
                                            "options": [
                                                        "7 colores",
                                                        "5 colores",
                                                        "10 colores",
                                                        "3 colores"
                                            ],
                                            "correct": 0,
                                            "hint": "Rojo, naranja, amarillo, verde, azul, a√±il y violeta. Cuenta cu√°ntos son.",
                                            "explanation": "El arco√≠ris tiene 7 COLORES: Rojo, Naranja, Amarillo, Verde, Azul, A√±il y Violeta. Se forman cuando la luz atraviesa gotas de lluvia. üåà"
                                },
                                {
                                            "instruction": "üêü ¬°Animales vertebrados e invertebrados! Como los Pokemon de agua:",
                                            "question": "¬øCu√°l de estos animales es INVERTEBRADO (no tiene columna vertebral ni huesos internos)?",
                                            "options": [
                                                        "Pulpo",
                                                        "Perro",
                                                        "Gato",
                                                        "P√°jaro"
                                            ],
                                            "correct": 0,
                                            "hint": "Los invertebrados no tienen huesos en su espalda. Piensa en animales blandos o con caparaz√≥n.",
                                            "explanation": "El PULPO es invertebrado porque no tiene columna vertebral ni huesos. Es un molusco con 8 tent√°culos. üêô"
                                },
                                {
                                            "instruction": "üåã ¬°Volcanes! Como cuando Groudon hace erupci√≥n:",
                                            "question": "¬øC√≥mo se llama la roca fundida super caliente que sale de un volc√°n?",
                                            "options": [
                                                        "Lava",
                                                        "Magma",
                                                        "Ceniza",
                                                        "Roca √≠gnea"
                                            ],
                                            "correct": 0,
                                            "hint": "Cuando est√° dentro del volc√°n se llama magma, pero cuando SALE y fluye se llama...",
                                            "explanation": "La roca fundida que SALE del volc√°n se llama LAVA. Dentro de la Tierra se llama magma. Puede alcanzar 1.200¬∞C. üåã"
                                },
                                {
                                            "instruction": "üëÇ ¬°Los sentidos! Como la vista de halc√≥n de Link:",
                                            "question": "¬øCu√°l sentido o sistema nos ayuda a mantener el equilibrio (como Sonic corriendo)?",
                                            "options": [
                                                        "El equilibrio (o√≠do interno)",
                                                        "La vista",
                                                        "El tacto",
                                                        "El olfato"
                                            ],
                                            "correct": 0,
                                            "hint": "Aunque no es uno de los 5 sentidos tradicionales, est√° relacionado con el o√≠do.",
                                            "explanation": "El EQUILIBRIO lo controla el o√≠do interno (aparato vestibular). Por eso cuando das muchas vueltas te mareas. üëÇ‚öñÔ∏è"
                                },
                                {
                                            "instruction": "üß≤ ¬°Magnetismo! Como los poderes de Magnezone Pokemon:",
                                            "question": "¬øCu√°les son los dos polos de un im√°n?",
                                            "options": [
                                                        "Norte y Sur",
                                                        "Positivo y Negativo",
                                                        "Este y Oeste",
                                                        "Arriba y Abajo"
                                            ],
                                            "correct": 0,
                                            "hint": "Son como los puntos cardinales de una br√∫jula que usa Link.",
                                            "explanation": "Los imanes tienen polo NORTE y polo SUR. Los polos opuestos se atraen (Norte con Sur), y los iguales se repelen. üß≤"
                                }
                    ],
                    "social": [
                                {
                                            "instruction": "üó∫Ô∏è ¬°Geograf√≠a de Espa√±a! Donde juega el Real Madrid:",
                                            "question": "¬øCu√°l es la capital de Espa√±a, donde est√° el estadio Santiago Bernab√©u?",
                                            "options": [
                                                        "Madrid",
                                                        "Barcelona",
                                                        "Sevilla",
                                                        "Valencia"
                                            ],
                                            "correct": 0,
                                            "hint": "Es la ciudad m√°s grande de Espa√±a y est√° en el centro del pa√≠s. El Real Madrid juega all√≠.",
                                            "explanation": "MADRID es la capital de Espa√±a desde 1561. Tiene m√°s de 3 millones de habitantes y es donde juega el Real Madrid. üá™üá∏"
                                },
                                {
                                            "instruction": "‚öîÔ∏è ¬°Historia de la Edad Media! Como en Ataque a los Titanes:",
                                            "question": "¬øC√≥mo se llamaban los soldados que iban a caballo con armadura de metal en la Edad Media?",
                                            "options": [
                                                        "Caballeros",
                                                        "Arqueros",
                                                        "Magos",
                                                        "Piratas"
                                            ],
                                            "correct": 0,
                                            "hint": "Usaban armadura de metal brillante y proteg√≠an castillos. Montaban a...",
                                            "explanation": "Los CABALLEROS eran guerreros nobles que luchaban montados a caballo. Usaban armadura, espada y escudo. ‚öîÔ∏èüõ°Ô∏è"
                                },
                                {
                                            "instruction": "üåç ¬°Los continentes! Donde viven Pokemon en el mundo real:",
                                            "question": "¬øCu√°ntos continentes hay en nuestro planeta Tierra?",
                                            "options": [
                                                        "7 continentes",
                                                        "5 continentes",
                                                        "6 continentes",
                                                        "8 continentes"
                                            ],
                                            "correct": 0,
                                            "hint": "Asia, √Åfrica, Europa, Am√©rica del Norte, Am√©rica del Sur, Ocean√≠a y...",
                                            "explanation": "Hay 7 CONTINENTES: Asia, √Åfrica, Am√©rica del Norte, Am√©rica del Sur, Ant√°rtida, Europa y Ocean√≠a. Asia es el m√°s grande. üåè"
                                },
                                {
                                            "instruction": "üèõÔ∏è ¬°Civilizaciones antiguas! Como en Dragon Ball:",
                                            "question": "¬øEn qu√© pa√≠s est√°n las famosas pir√°mides de Giza que parecen de Dragon Ball?",
                                            "options": [
                                                        "Egipto",
                                                        "M√©xico",
                                                        "China",
                                                        "Grecia"
                                            ],
                                            "correct": 0,
                                            "hint": "Es un pa√≠s de √Åfrica que est√° junto al r√≠o Nilo. Las pir√°mides tienen miles de a√±os.",
                                            "explanation": "Las pir√°mides de Giza est√°n en EGIPTO, junto al r√≠o Nilo. Fueron construidas hace m√°s de 4.500 a√±os. üèúÔ∏è"
                                },
                                {
                                            "instruction": "üí∞ ¬°Econom√≠a! La moneda de Europa:",
                                            "question": "¬øCu√°l es la moneda que se usa en Espa√±a, Francia, Italia y muchos pa√≠ses de Europa?",
                                            "options": [
                                                        "Euro",
                                                        "D√≥lar",
                                                        "Libra",
                                                        "Peso"
                                            ],
                                            "correct": 0,
                                            "hint": "Su s√≠mbolo es ‚Ç¨. Es la moneda oficial de muchos pa√≠ses europeos.",
                                            "explanation": "El EURO (‚Ç¨) es la moneda oficial de 20 pa√≠ses de la Uni√≥n Europea, incluyendo Espa√±a. Se introdujo en 2002. üí∂"
                                },
                                {
                                            "instruction": "üóΩ ¬°Monumentos famosos! Donde viven los Vengadores:",
                                            "question": "¬øEn qu√© ciudad de Estados Unidos est√° la famosa Estatua de la Libertad?",
                                            "options": [
                                                        "Nueva York",
                                                        "Par√≠s",
                                                        "Londres",
                                                        "Roma"
                                            ],
                                            "correct": 0,
                                            "hint": "Es la ciudad m√°s grande de Estados Unidos. Spider-Man vive all√≠.",
                                            "explanation": "La Estatua de la Libertad est√° en NUEVA YORK, Estados Unidos. Fue un regalo de Francia en 1886. Mide 93 metros. üóΩ"
                                },
                                {
                                            "instruction": "üåä ¬°Oc√©anos del mundo! Donde nadan los Pokemon de agua:",
                                            "question": "¬øCu√°l es el oc√©ano m√°s grande del planeta donde vive Kyogre?",
                                            "options": [
                                                        "Oc√©ano Pac√≠fico",
                                                        "Oc√©ano Atl√°ntico",
                                                        "Oc√©ano √çndico",
                                                        "Oc√©ano √Årtico"
                                            ],
                                            "correct": 0,
                                            "hint": "Su nombre significa 'tranquilo'. Est√° entre Am√©rica y Asia. Es enorme.",
                                            "explanation": "El OC√âANO PAC√çFICO es el m√°s grande del mundo, cubre m√°s de 165 millones de km¬≤. ¬°Es m√°s grande que todos los continentes juntos! üåä"
                                },
                                {
                                            "instruction": "üë• ¬°Derechos humanos! Como los derechos de los ninjas en Naruto:",
                                            "question": "¬øCu√°l de estos es un derecho fundamental de todos los ni√±os del mundo?",
                                            "options": [
                                                        "Derecho a la educaci√≥n",
                                                        "Derecho a trabajar",
                                                        "Derecho a conducir",
                                                        "Derecho a votar"
                                            ],
                                            "correct": 0,
                                            "hint": "Todos los ni√±os deben poder ir a...",
                                            "explanation": "El DERECHO A LA EDUCACI√ìN es fundamental. Todos los ni√±os tienen derecho a aprender y ir a la escuela. üìö"
                                },
                                {
                                            "instruction": "üó∫Ô∏è ¬°Comunidades de Espa√±a! Donde juegan diferentes equipos:",
                                            "question": "¬øCu√°ntas Comunidades Aut√≥nomas tiene Espa√±a?",
                                            "options": [
                                                        "17 Comunidades",
                                                        "15 Comunidades",
                                                        "20 Comunidades",
                                                        "12 Comunidades"
                                            ],
                                            "correct": 0,
                                            "hint": "Incluye Catalu√±a (Bar√ßa), Madrid (Real Madrid), Andaluc√≠a, Arag√≥n... cuenta bien todas.",
                                            "explanation": "Espa√±a tiene 17 COMUNIDADES AUT√ìNOMAS m√°s 2 ciudades aut√≥nomas (Ceuta y Melilla). Cada una tiene caracter√≠sticas √∫nicas. üá™üá∏"
                                },
                                {
                                            "instruction": "‚è∞ ¬°La medida del tiempo! Como los siglos en la historia:",
                                            "question": "¬øCu√°ntos a√±os forman un siglo?",
                                            "options": [
                                                        "100 a√±os",
                                                        "50 a√±os",
                                                        "10 a√±os",
                                                        "1.000 a√±os"
                                            ],
                                            "correct": 0,
                                            "hint": "Un siglo es mucho tiempo. Es un n√∫mero redondo muy grande. Del a√±o 2000 al 2100.",
                                            "explanation": "Un SIGLO son 100 A√ëOS. Estamos en el siglo XXI (21), que comenz√≥ en el a√±o 2001 y terminar√° en 2100. ‚è∞"
                                },
                                {
                                            "instruction": "üèîÔ∏è ¬°Geograf√≠a f√≠sica de Espa√±a! Los r√≠os m√°s importantes:",
                                            "question": "¬øCu√°l es el r√≠o m√°s largo de la Pen√≠nsula Ib√©rica?",
                                            "options": [
                                                        "R√≠o Tajo",
                                                        "R√≠o Ebro",
                                                        "R√≠o Duero",
                                                        "R√≠o Guadalquivir"
                                            ],
                                            "correct": 0,
                                            "hint": "Pasa por Toledo y desemboca en Lisboa, Portugal. Es el m√°s largo.",
                                            "explanation": "El R√çO TAJO es el m√°s largo de la Pen√≠nsula Ib√©rica con 1.008 km. Nace en Teruel y desemboca en Lisboa. üèûÔ∏è"
                                },
                                {
                                            "instruction": "üåê ¬°Las banderas! Los colores de Espa√±a:",
                                            "question": "¬øDe qu√© colores son las franjas de la bandera de Espa√±a?",
                                            "options": [
                                                        "Rojo y amarillo",
                                                        "Azul y blanco",
                                                        "Verde y rojo",
                                                        "Rojo y blanco"
                                            ],
                                            "correct": 0,
                                            "hint": "Son dos colores. Uno es el color del sol y el otro del fuego. El Real Madrid juega con estos colores nacionales.",
                                            "explanation": "La bandera de Espa√±a tiene franjas ROJA-AMARILLA-ROJA. La franja amarilla es el doble de ancha que cada roja. üá™üá∏"
                                },
                                {
                                            "instruction": "üèõÔ∏è ¬°Democracia y gobierno! Qui√©n dirige un pa√≠s:",
                                            "question": "¬øC√≥mo se llama la persona que dirige el gobierno de un pa√≠s?",
                                            "options": [
                                                        "Presidente o Primer Ministro",
                                                        "Rey o Reina",
                                                        "Alcalde",
                                                        "Gobernador"
                                            ],
                                            "correct": 0,
                                            "hint": "En Espa√±a se llama Presidente del Gobierno. Es quien toma las decisiones pol√≠ticas importantes.",
                                            "explanation": "El l√≠der del gobierno puede ser PRESIDENTE (como en USA) o PRIMER MINISTRO (como en Espa√±a o Reino Unido). Es elegido por votaci√≥n. üèõÔ∏è"
                                },
                                {
                                            "instruction": "üóìÔ∏è ¬°Historia de Espa√±a! El descubrimiento de Am√©rica:",
                                            "question": "¬øEn qu√© a√±o descubri√≥ Crist√≥bal Col√≥n Am√©rica con sus tres carabelas?",
                                            "options": [
                                                        "1492",
                                                        "1500",
                                                        "1400",
                                                        "1600"
                                            ],
                                            "correct": 0,
                                            "hint": "Es un a√±o muy famoso del siglo XV. Las carabelas: La Ni√±a, La Pinta y La Santa Mar√≠a.",
                                            "explanation": "Crist√≥bal Col√≥n lleg√≥ a Am√©rica el 12 de octubre de 1492. Sali√≥ del Puerto de Palos con tres carabelas. üö¢"
                                },
                                {
                                            "instruction": "üåç ¬°Pa√≠ses y capitales de Europa! La ciudad de la Torre Eiffel:",
                                            "question": "¬øCu√°l es la capital de Francia, donde juega Mbapp√© con el PSG?",
                                            "options": [
                                                        "Par√≠s",
                                                        "Londres",
                                                        "Berl√≠n",
                                                        "Roma"
                                            ],
                                            "correct": 0,
                                            "hint": "Es la ciudad de la Torre Eiffel y el r√≠o Sena. La ciudad del amor.",
                                            "explanation": "PAR√çS es la capital de Francia. Es famosa por la Torre Eiffel, el Museo del Louvre y Notre Dame. Se le llama 'La Ciudad de la Luz'. üóº"
                                },
                                {
                                            "instruction": "üè∞ ¬°Edad Media! Los castillos como las murallas de Ataque a los Titanes:",
                                            "question": "¬øC√≥mo se llamaban los palacios fortificados donde viv√≠an los reyes y nobles en la Edad Media?",
                                            "options": [
                                                        "Castillos",
                                                        "Iglesias",
                                                        "Mezquitas",
                                                        "Catedrales"
                                            ],
                                            "correct": 0,
                                            "hint": "Ten√≠an murallas gruesas, torres altas y un foso con agua alrededor. Proteg√≠an de los ataques.",
                                            "explanation": "Los CASTILLOS eran fortalezas donde viv√≠an reyes y nobles. Ten√≠an murallas, torres de vigilancia, un puente levadizo y a veces un foso. üè∞‚öîÔ∏è"
                                },
                                {
                                            "instruction": "üåè ¬°La poblaci√≥n mundial! Los pa√≠ses m√°s poblados:",
                                            "question": "¬øCu√°l es el pa√≠s con m√°s habitantes del mundo actualmente?",
                                            "options": [
                                                        "India",
                                                        "China",
                                                        "Estados Unidos",
                                                        "Indonesia"
                                            ],
                                            "correct": 0,
                                            "hint": "Hasta 2023 era China, pero ahora otro pa√≠s asi√°tico gigante lo ha superado.",
                                            "explanation": "INDIA es actualmente el pa√≠s m√°s poblado del mundo con m√°s de 1.400 millones de habitantes, superando a China. üë•"
                                },
                                {
                                            "instruction": "üìÖ ¬°El calendario! Organizando el tiempo:",
                                            "question": "¬øCu√°ntos meses tiene un a√±o completo?",
                                            "options": [
                                                        "12 meses",
                                                        "10 meses",
                                                        "11 meses",
                                                        "13 meses"
                                            ],
                                            "correct": 0,
                                            "hint": "Enero, Febrero, Marzo... cuenta hasta Diciembre. Son los meses del a√±o.",
                                            "explanation": "Un a√±o tiene 12 MESES. Algunos tienen 31 d√≠as, otros 30, y febrero tiene 28 (o 29 en a√±o bisiesto). üìÖ"
                                }
                    ]
        };

        const achievements = [
            { id: 'first_day', name: '¬°Primer D√≠a Genial!', description: 'Completa tu primer d√≠a de ejercicios', icon: 'üåü' },
            { id: 'week_warrior', name: 'Guerrero de la Semana', description: 'Completa una semana completa', icon: '‚öîÔ∏è' },
            { id: 'perfect_score', name: 'Perfecci√≥n Total', description: 'Consigue 100% en todos los ejercicios de un d√≠a', icon: 'üíØ' },
            { id: 'streak_5', name: 'Racha de Fuego', description: 'Mant√©n una racha de 5 d√≠as', icon: 'üî•' },
            { id: 'streak_10', name: 'Imparable', description: 'Mant√©n una racha de 10 d√≠as', icon: '‚ö°' },
            { id: 'math_master', name: 'Maestro de Mates', description: 'Completa 20 ejercicios de matem√°ticas', icon: 'üßÆ' },
            { id: 'reading_pro', name: 'S√∫per Lector', description: 'Completa 20 ejercicios de lectura', icon: 'üìö' },
            { id: 'science_genius', name: 'Genio Cient√≠fico', description: 'Completa 20 ejercicios de ciencias', icon: 'üî¨' },
            { id: 'social_expert', name: 'Experto Social', description: 'Completa 20 ejercicios de sociales', icon: 'üåç' },
            { id: 'century_club', name: 'Club del Centenar', description: 'Completa 100 ejercicios en total', icon: 'üí™' },
            { id: 'speed_demon', name: 'Rayo Veloz', description: 'Completa un d√≠a en menos de 20 minutos', icon: '‚ö°' }
        ];

        function updateConnectionStatus(status) {
            const statusElement = document.getElementById('connectionStatus');
            const statusText = document.getElementById('statusText');
            
            statusElement.className = 'connection-status ' + status;
            
            const statusMessages = {
                'online': '‚úÖ Conectado',
                'offline': '‚ö†Ô∏è Desconectado',
                'connecting': 'üîÑ Conectando...',
                'error': '‚ùå Error'
            };
            
            statusText.textContent = statusMessages[status] || 'Desconocido';
        }

        function createNewUser() {
            return {
                totalPoints: 0,
                streak: 0,
                lastActiveDate: null,
                achievements: [],
                completedDays: [],
                totalExercises: 0,
                correctAnswers: 0,
                totalAttempts: 0, // NUEVO: Total de intentos (incluye fallos)
                wrongAnswers: 0,   // NUEVO: Respuestas incorrectas
                exercisesByType: {
                    math: 0,
                    reading: 0,
                    science: 0,
                    social: 0
                },
                dailyProgress: {}
            };
        }

        function ensureUserDataStructure(userData) {
            if (!userData) return createNewUser();
            
            // Asegurar que existan todas las propiedades
            if (!userData.exercisesByType) {
                userData.exercisesByType = {
                    math: 0,
                    reading: 0,
                    science: 0,
                    social: 0
                };
            }
            if (!userData.achievements) userData.achievements = [];
            if (!userData.completedDays) userData.completedDays = [];
            if (typeof userData.totalPoints !== 'number') userData.totalPoints = 0;
            if (typeof userData.streak !== 'number') userData.streak = 0;
            if (typeof userData.totalExercises !== 'number') userData.totalExercises = 0;
            if (typeof userData.correctAnswers !== 'number') userData.correctAnswers = 0;
            if (typeof userData.totalAttempts !== 'number') userData.totalAttempts = 0;
            if (typeof userData.wrongAnswers !== 'number') userData.wrongAnswers = 0;
            
            return userData;
        }

        // ==================== FUNCIONES DE NORMALIZACI√ìN ====================
        
        /**
         * Normaliza la estructura de datos de un usuario al formato est√°ndar
         * Maneja tanto el formato antiguo como el nuevo
         */
        function normalizeUserData(userData, username) {
            console.log(`üîß Normalizando datos para usuario: ${username}`);
            
            // Si ya tiene la estructura correcta, solo asegurar campos
            const normalized = ensureUserDataStructure(userData);
            
            // Convertir completedDays (string array) a array si es necesario
            if (normalized.completedDays && typeof normalized.completedDays === 'object' && !Array.isArray(normalized.completedDays)) {
                // Si completedDays es un objeto en lugar de array, convertirlo
                normalized.completedDays = Object.values(normalized.completedDays).filter(v => typeof v === 'string');
            }
            
            // Asegurar que completedDays sea un array
            if (!Array.isArray(normalized.completedDays)) {
                normalized.completedDays = [];
            }
            
            console.log('‚úÖ Datos normalizados para', username);
            return normalized;
        }

        /**
         * Limpia y normaliza toda la estructura de datos
         * MANTIENE usuarios en la ra√≠z como en el archivo original
         * Mueve usuarios que est√©n dentro de un objeto 'users' a la ra√≠z
         */
        function cleanAndNormalizeAllData(data) {
            console.log('üßπ Iniciando limpieza y normalizaci√≥n de datos...');
            
            const cleaned = {};
            
            // Campos del sistema que no son usuarios
            const systemFields = ['currentWeek', 'currentDay', 'currentExercise', 'stars', 
                                 'correctAnswers', 'daysCompleted', 'completedDays', 'startTime',
                                 'currentColor', 'totalFailures', 'currentExerciseFailures',
                                 'failuresByExercise', 'exerciseAttempts', 'users'];
            
            // Primero, si hay un objeto 'users', mover sus usuarios a la ra√≠z
            if (data.users && typeof data.users === 'object') {
                console.log('‚ö†Ô∏è Detectado objeto "users" - moviendo usuarios a la ra√≠z');
                Object.keys(data.users).forEach(username => {
                    console.log(`üîÑ Moviendo usuario de users.${username} a ra√≠z`);
                    cleaned[username] = normalizeUserData(data.users[username], username);
                });
            }
            
            // Procesar todos los campos en la ra√≠z
            Object.keys(data).forEach(key => {
                const value = data[key];
                
                // Si es un campo del sistema, ignorarlo (no lo necesitamos en la nueva estructura)
                if (systemFields.includes(key)) {
                    return;
                }
                
                // Si parece datos de usuario (tiene campos como totalPoints, streak, etc.)
                if (value && typeof value === 'object' && 
                    (value.totalPoints !== undefined || value.streak !== undefined || 
                     value.achievements !== undefined || value.totalExercises !== undefined ||
                     value.completedDays !== undefined)) {
                    
                    console.log(`üë§ Usuario encontrado en ra√≠z: ${key}`);
                    // Si ya lo procesamos desde 'users', no sobrescribir
                    if (!cleaned[key]) {
                        cleaned[key] = normalizeUserData(value, key);
                    }
                }
            });
            
            console.log('‚úÖ Limpieza completada. Usuarios encontrados:', Object.keys(cleaned));
            return cleaned;
        }
        
        // ==================== FIN FUNCIONES DE NORMALIZACI√ìN ====================

        async function login() {
            const username = document.getElementById('usernameInput').value.trim();
            const password = document.getElementById('passwordInput').value;
            
            if (!username) {
                alert('¬°Por favor escribe tu nombre de entrenador! üòä');
                return;
            }
            
            if (!password) {
                alert('¬°Por favor escribe tu contrase√±a secreta! üîê');
                return;
            }
            
            // üîê VERIFICAR USUARIO Y CONTRASE√ëA
            if (!verificarCredenciales(username, password)) {
                alert('‚ùå Acceso Denegado\n\n' +
                      'Usuario o contrase√±a incorrectos.\n\n' +
                      'Verifica que hayas escrito bien tu nombre y contrase√±a.\n' +
                      'Si no tienes acceso, contacta al administrador. üîê');
                // Limpiar campo de contrase√±a
                document.getElementById('passwordInput').value = '';
                return;
            }
            
            try {
                appState.currentUser = username;
                const displayElement = document.getElementById('currentUserDisplay');
                if (displayElement) {
                    displayElement.textContent = username;
                }
                
                updateConnectionStatus('connecting');
                await loadUserData();
                
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                
                updateUserInterface();
                generateWeeks();
                
                // Cargar las pesta√±as iniciales
                loadStats();
                loadAchievements();
                loadRanking();
                
                console.log('‚úÖ Login completado exitosamente');
            } catch (error) {
                console.error('‚ùå Error en login:', error);
                updateConnectionStatus('error');
                alert('‚ùå Error al iniciar sesi√≥n. Por favor, intenta de nuevo.');
            }
        }

        async function loadUserData() {
            try {
                const response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${JSONBIN_CONFIG.binId}/latest`, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': JSONBIN_CONFIG.masterKey
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('üì¶ Datos recibidos del servidor:', data.record);
                    
                    // ====== APLICAR LIMPIEZA Y NORMALIZACI√ìN ======
                    appState.allUsersData = cleanAndNormalizeAllData(data.record || {});
                    console.log('‚ú® Datos normalizados:', appState.allUsersData);
                    
                    if (!appState.allUsersData[appState.currentUser]) {
                        appState.allUsersData[appState.currentUser] = createNewUser();
                    }
                    
                    appState.userData = normalizeUserData(appState.allUsersData[appState.currentUser], appState.currentUser);
                    
                    // Guardar la versi√≥n limpia de vuelta al servidor
                    await saveUserData();
                    
                    updateConnectionStatus('online');
                    checkStreak();
                } else {
                    throw new Error('Error al cargar datos');
                }
            } catch (error) {
                console.error('Error:', error);
                updateConnectionStatus('error');
                
                appState.allUsersData[appState.currentUser] = createNewUser();
                appState.userData = ensureUserDataStructure(appState.allUsersData[appState.currentUser]);
            }
        }

        async function saveUserData() {
            try {
                appState.allUsersData[appState.currentUser] = appState.userData;
                
                const response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${JSONBIN_CONFIG.binId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': JSONBIN_CONFIG.masterKey
                    },
                    body: JSON.stringify(appState.allUsersData)
                });
                
                if (response.ok) {
                    updateConnectionStatus('online');
                } else {
                    throw new Error('Error al guardar');
                }
            } catch (error) {
                console.error('Error al guardar:', error);
                updateConnectionStatus('error');
            }
        }

        function checkStreak() {
            const today = new Date().toDateString();
            const lastActive = appState.userData.lastActiveDate;
            
            if (!lastActive) {
                appState.userData.streak = 0;
                return;
            }
            
            const lastDate = new Date(lastActive);
            const diffTime = new Date(today) - lastDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays > 1) {
                appState.userData.streak = 0;
            }
        }

        function updateUserInterface() {
            const userData = appState.userData || createNewUser();
            
            document.getElementById('userName').textContent = appState.currentUser || 'Entrenador';
            document.getElementById('userAvatar').textContent = appState.currentUser ? appState.currentUser[0].toUpperCase() : 'üéÆ';
            document.getElementById('totalPoints').textContent = userData.totalPoints || 0;
            document.getElementById('streak').textContent = userData.streak || 0;
            document.getElementById('achievements').textContent = (userData.achievements && userData.achievements.length) || 0;
            
            const level = Math.floor(userData.totalPoints / 100) + 1;
            const levelNames = {
                1: 'Novato Genial',
                2: 'Aprendiz S√∫per',
                3: 'Estudiante Pro',
                4: 'Experto Total',
                5: 'Maestro Pokemon',
                10: '¬°CAMPE√ìN LEGENDARIO!'
            };
            const levelName = levelNames[Math.min(level, 10)] || `Nivel ${level}`;
            document.getElementById('userLevel').textContent = `Nivel ${level} - ${levelName}`;
        }

        function generateWeeks() {
            const container = document.getElementById('weeksContainer');
            container.innerHTML = '';
            
            const today = new Date();
            const weeks = 1;
            
            for (let week = 0; week < weeks; week++) {
                const weekDiv = document.createElement('div');
                weekDiv.style.marginBottom = '40px';
                
                const weekHeader = document.createElement('h3');
                weekHeader.style.fontFamily = "'Fredoka One', cursive";
                weekHeader.style.fontSize = '24px';
                weekHeader.style.marginBottom = '20px';
                weekHeader.style.color = '#2d3436';
                weekHeader.textContent = `üåü Semana ${week + 1}`;
                weekDiv.appendChild(weekHeader);
                
                const grid = document.createElement('div');
                grid.className = 'calendar-grid';
                
                const dayNames = ['L', 'M', 'X', 'J', 'V', 'S', 'D'];
                dayNames.forEach(day => {
                    const header = document.createElement('div');
                    header.className = 'day-header';
                    header.textContent = day;
                    grid.appendChild(header);
                });
                
                const startDate = new Date(today);
                startDate.setDate(today.getDate() - today.getDay() + 1 + (week * 7));
                
                const firstDayOfWeek = startDate.getDay() === 0 ? 6 : startDate.getDay() - 1;
                
                for (let i = 0; i < firstDayOfWeek; i++) {
                    const emptyCell = document.createElement('div');
                    emptyCell.className = 'day-cell empty';
                    grid.appendChild(emptyCell);
                }
                
                for (let day = 0; day < 7; day++) {
                    const currentDate = new Date(startDate);
                    currentDate.setDate(startDate.getDate() + day);
                    
                    const dayCell = document.createElement('div');
                    dayCell.className = 'day-cell';
                    
                    const dayNumber = document.createElement('div');
                    dayNumber.className = 'day-number';
                    dayNumber.textContent = currentDate.getDate();
                    dayCell.appendChild(dayNumber);
                    
                    const dateKey = currentDate.toDateString();
                    const isCompleted = appState.userData.completedDays.includes(dateKey);
                    const isToday = dateKey === today.toDateString();
                    const isPast = currentDate < today && !isToday;
                    const isFuture = currentDate > today;
                    
                    const statusIcon = document.createElement('div');
                    statusIcon.className = 'day-status';
                    
                    if (isCompleted) {
                        dayCell.classList.add('completed');
                        statusIcon.textContent = '‚úÖ';
                    } else if (isToday) {
                        dayCell.classList.add('current');
                        statusIcon.textContent = 'üéØ';
                    } else if (isFuture) {
                        dayCell.classList.add('disabled');
                        statusIcon.textContent = 'üîí';
                    } else if (isPast) {
                        // Los d√≠as pasados NO completados est√°n disponibles para recuperar
                        dayCell.classList.add('recoverable');
                        statusIcon.textContent = 'üìù';
                    }
                    
                    dayCell.appendChild(statusIcon);
                    
                    // Permitir click en d√≠a actual O d√≠as pasados no completados
                    if ((isToday || isPast) && !isCompleted) {
                        dayCell.onclick = () => startDayExercises(dateKey);
                        dayCell.style.cursor = 'pointer';
                    }
                    
                    grid.appendChild(dayCell);
                }
                
                weekDiv.appendChild(grid);
                container.appendChild(weekDiv);
            }
        }

        /**
         * Genera ejercicios √∫nicos para cada d√≠a de la semana
         * Cada semana tiene 7 d√≠as (L-D) con 10 ejercicios cada uno (70 ejercicios/semana)
         * Los ejercicios NO se repiten dentro de la misma semana
         */
        function generateDailyExercises() {
            const dateKey = appState.currentDay || new Date().toDateString();
            const date = new Date(dateKey);
            
            // Calcular n√∫mero de semana y d√≠a de la semana (0=Domingo, 1=Lunes, ..., 6=S√°bado)
            const weekNumber = getWeekNumber(date);
            const dayOfWeek = date.getDay(); // 0=Domingo, 1=Lunes, 2=Martes, etc.
            
            console.log(`üìÖ Generando ejercicios para: ${dateKey}, Semana ${weekNumber}, D√≠a ${dayOfWeek}`);
            
            // Crear un pool de todos los ejercicios disponibles
            const allExercises = [];
            const subjects = ['math', 'reading', 'science', 'social'];
            
            subjects.forEach(subject => {
                exerciseBank[subject].forEach((exercise, index) => {
                    allExercises.push({
                        ...exercise,
                        subject: subject,
                        id: `${subject}_${index}` // ID √∫nico para cada ejercicio
                    });
                });
            });
            
            console.log(`üìö Total ejercicios en el banco: ${allExercises.length}`);
            
            // Usar semana como seed para shufflear
            const weekSeed = hashString(`week_${weekNumber}`);
            
            // Shufflear todos los ejercicios de forma determin√≠stica para esta semana
            const weekExercises = [...allExercises].sort((a, b) => {
                const hashA = hashString(a.id + weekSeed);
                const hashB = hashString(b.id + weekSeed);
                return hashA - hashB;
            });
            
            // Dividir los ejercicios en 7 d√≠as (10 ejercicios por d√≠a)
            const exercisesPerDay = 10;
            const startIndex = dayOfWeek * exercisesPerDay;
            const endIndex = startIndex + exercisesPerDay;
            
            // Obtener los ejercicios para este d√≠a espec√≠fico
            const todayExercises = weekExercises.slice(startIndex, endIndex);
            
            // Si no hay suficientes ejercicios (banco peque√±o), repetir desde el principio
            if (todayExercises.length < exercisesPerDay) {
                const needed = exercisesPerDay - todayExercises.length;
                const additional = weekExercises.slice(0, needed);
                todayExercises.push(...additional);
            }
            
            console.log(`‚úÖ Ejercicios del d√≠a ${dayOfWeek}: ${todayExercises.length} ejercicios`);
            console.log(`üìù IDs: ${todayExercises.map(e => e.id).join(', ')}`);
            
            return todayExercises;
        }

        /**
         * Calcula el n√∫mero de semana del a√±o
         */
        function getWeekNumber(date) {
            const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
            const dayNum = d.getUTCDay() || 7;
            d.setUTCDate(d.getUTCDate() + 4 - dayNum);
            const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));
            return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
        }

        // Funci√≥n para crear un hash simple y determin√≠stico de una cadena
        function hashString(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convertir a entero de 32 bits
            }
            return Math.abs(hash);
        }

        function startDayExercises(dateKey) {
            appState.currentDay = dateKey;
            appState.currentExerciseIndex = 0;
            appState.currentExercises = generateDailyExercises();
            appState.sessionStartTime = Date.now();
            appState.timeRemaining = 1800;
            
            document.getElementById('exerciseModal').style.display = 'flex';
            updateProgressIndicator();
            startTimer();
            loadExercise();
        }

        function startTimer() {
            if (appState.timerInterval) {
                clearInterval(appState.timerInterval);
            }
            
            appState.timerInterval = setInterval(() => {
                appState.timeRemaining--;
                
                const minutes = Math.floor(appState.timeRemaining / 60);
                const seconds = appState.timeRemaining % 60;
                document.getElementById('timerDisplay').textContent = 
                    `‚è±Ô∏è Tiempo: ${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (appState.timeRemaining <= 0) {
                    clearInterval(appState.timerInterval);
                    alert('‚è∞ ¬°Se acab√≥ el tiempo! Pero no te preocupes, ¬°puedes seguir ma√±ana! üí™');
                    closeExerciseModal();
                }
            }, 1000);
        }

        function updateProgressIndicator() {
            const container = document.getElementById('progressIndicator');
            container.innerHTML = '';
            
            appState.currentExercises.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = 'progress-dot';
                if (index < appState.currentExerciseIndex) {
                    dot.classList.add('completed');
                } else if (index === appState.currentExerciseIndex) {
                    dot.classList.add('current');
                }
                container.appendChild(dot);
            });
        }

        function loadExercise() {
            const exercise = appState.currentExercises[appState.currentExerciseIndex];
            const container = document.getElementById('exerciseContainer');
            
            document.getElementById('exerciseTitle').textContent = 
                `Ejercicio ${appState.currentExerciseIndex + 1} de ${appState.currentExercises.length}`;
            
            const badges = document.getElementById('subjectBadges');
            badges.innerHTML = `<span class="subject-badge ${exercise.subject}">${getSubjectName(exercise.subject)}</span>`;
            
            document.getElementById('hintBox').classList.remove('visible');
            document.getElementById('feedbackBox').classList.remove('visible');
            document.getElementById('explanationBox').classList.remove('visible');
            document.getElementById('checkBtn').style.display = 'inline-block';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('hintBtn').style.display = 'inline-block';
            appState.selectedAnswer = null;
            
            container.innerHTML = '';
            
            // Instrucci√≥n
            if (exercise.instruction) {
                const instructionDiv = document.createElement('div');
                instructionDiv.className = 'instruction-box';
                instructionDiv.innerHTML = `
                    <h4>üìã Instrucciones</h4>
                    <p>${exercise.instruction}</p>
                `;
                container.appendChild(instructionDiv);
            }
            
            // Texto de lectura LARGO si existe
            if (exercise.passage) {
                const passageDiv = document.createElement('div');
                passageDiv.className = 'reading-passage';
                
                if (exercise.passageTitle) {
                    passageDiv.innerHTML = `<h4>${exercise.passageTitle}</h4>`;
                }
                
                const paragraphs = exercise.passage.split('\n\n');
                paragraphs.forEach(para => {
                    const p = document.createElement('p');
                    p.textContent = para;
                    passageDiv.appendChild(p);
                });
                
                container.appendChild(passageDiv);
            }
            
            // Pregunta
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-container';
            
            const questionText = document.createElement('div');
            questionText.className = 'question-text';
            questionText.textContent = exercise.question;
            questionDiv.appendChild(questionText);
            
            // Opciones
            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'options-container';
            
            exercise.options.forEach((option, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = option;
                btn.onclick = () => selectOption(index);
                optionsContainer.appendChild(btn);
            });
            
            questionDiv.appendChild(optionsContainer);
            container.appendChild(questionDiv);
        }

        function getSubjectName(subject) {
            const names = {
                'math': 'üßÆ Matem√°ticas',
                'reading': 'üìñ Lengua',
                'science': 'üî¨ Ciencias Naturales',
                'social': 'üåç Ciencias Sociales'
            };
            return names[subject] || subject;
        }

        function selectOption(index) {
            document.querySelectorAll('.option-btn').forEach((btn, i) => {
                btn.classList.remove('selected');
                if (i === index) {
                    btn.classList.add('selected');
                }
            });
            appState.selectedAnswer = index;
        }

        function showHint() {
            const exercise = appState.currentExercises[appState.currentExerciseIndex];
            document.getElementById('hintText').textContent = exercise.hint;
            document.getElementById('hintBox').classList.add('visible');
        }

        function checkAnswer() {
            const exercise = appState.currentExercises[appState.currentExerciseIndex];
            
            if (appState.selectedAnswer === null) {
                alert('¬°Por favor selecciona una respuesta primero! üòä');
                return;
            }
            
            const isCorrect = appState.selectedAnswer === exercise.correct;
            
            // REGISTRAR INTENTO
            appState.userData.totalAttempts++;
            
            document.querySelectorAll('.option-btn').forEach((btn, index) => {
                btn.style.pointerEvents = 'none';
                if (index === exercise.correct) {
                    btn.classList.add('correct');
                } else if (index === appState.selectedAnswer && !isCorrect) {
                    btn.classList.add('incorrect');
                }
            });
            
            appState.userData.totalExercises++;
            appState.userData.exercisesByType[exercise.subject]++;
            
            if (isCorrect) {
                appState.userData.correctAnswers++;
                appState.userData.totalPoints += 10;
                showFeedback(true, exercise);
            } else {
                // REGISTRAR FALLO Y PENALIZAR
                appState.userData.wrongAnswers++;
                // Penalizaci√≥n: -3 puntos por error (pero nunca bajar de 0)
                appState.userData.totalPoints = Math.max(0, appState.userData.totalPoints - 3);
                showFeedback(false, exercise);
            }
            
            showExplanation(exercise);
            
            document.getElementById('checkBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'inline-block';
            document.getElementById('hintBtn').style.display = 'none';
            
            updateUserInterface();
        }

        function showFeedback(isCorrect, exercise) {
            const feedbackBox = document.getElementById('feedbackBox');
            const feedbackText = document.getElementById('feedbackText');
            
            feedbackBox.className = 'feedback-box visible';
            
            if (isCorrect) {
                feedbackBox.classList.add('correct');
                const messages = [
                    'üéâ ¬°S√∫per correcto! ¬°Eres genial!',
                    '‚≠ê ¬°Perfecto! ¬°Lo has clavado!',
                    'üåü ¬°Incre√≠ble! ¬°Sigue as√≠!',
                    'üí™ ¬°Excelente trabajo, campe√≥n!',
                    'üèÜ ¬°Bravo! ¬°Eres un crack!'
                ];
                feedbackText.textContent = messages[Math.floor(Math.random() * messages.length)];
            } else {
                feedbackBox.classList.add('incorrect');
                const correctAnswerText = exercise.options[exercise.correct];
                
                feedbackText.innerHTML = `
                    ‚ùå ¬°Ups! No es correcto esta vez.<br>
                    <span style="font-size: 16px; margin-top: 10px; display: block;">
                        La respuesta correcta es: <strong>${correctAnswerText}</strong><br>
                        ¬°No te preocupes, sigue intent√°ndolo! üí™
                    </span>
                `;
            }
        }

        function showExplanation(exercise) {
            const explanationBox = document.getElementById('explanationBox');
            const explanationText = document.getElementById('explanationText');
            
            if (exercise.explanation) {
                explanationText.textContent = exercise.explanation;
                explanationBox.classList.add('visible');
            }
        }

        function nextExercise() {
            appState.currentExerciseIndex++;
            
            if (appState.currentExerciseIndex >= appState.currentExercises.length) {
                completeDayExercises();
            } else {
                updateProgressIndicator();
                loadExercise();
            }
        }

        function completeDayExercises() {
            clearInterval(appState.timerInterval);
            
            const dateKey = appState.currentDay;
            if (!appState.userData.completedDays.includes(dateKey)) {
                appState.userData.completedDays.push(dateKey);
            }
            
            const today = new Date().toDateString();
            if (!appState.userData.lastActiveDate || new Date(appState.userData.lastActiveDate).toDateString() !== today) {
                appState.userData.streak++;
                appState.userData.lastActiveDate = today;
            }
            
            const timeTaken = (Date.now() - appState.sessionStartTime) / 1000;
            
            checkAchievements(timeTaken);
            saveUserData();
            
            alert(`üéâ ¬°S√∫per bien hecho! ¬°Has completado el d√≠a!\n\n‚≠ê Puntos ganados: ${appState.userData.totalPoints}\nüî• Racha actual: ${appState.userData.streak} d√≠as`);
            
            closeExerciseModal();
            generateWeeks();
            updateUserInterface();
        }

        function checkAchievements(timeTaken) {
            const toCheck = [];
            
            if (appState.userData.completedDays.length === 1) {
                toCheck.push('first_day');
            }
            if (appState.userData.completedDays.length === 7) {
                toCheck.push('week_warrior');
            }
            if (appState.userData.streak === 5) {
                toCheck.push('streak_5');
            }
            if (appState.userData.streak === 10) {
                toCheck.push('streak_10');
            }
            if (appState.userData.exercisesByType.math >= 20) {
                toCheck.push('math_master');
            }
            if (appState.userData.exercisesByType.reading >= 20) {
                toCheck.push('reading_pro');
            }
            if (appState.userData.exercisesByType.science >= 20) {
                toCheck.push('science_genius');
            }
            if (appState.userData.exercisesByType.social >= 20) {
                toCheck.push('social_expert');
            }
            if (appState.userData.totalExercises >= 100) {
                toCheck.push('century_club');
            }
            if (timeTaken < 1200) {
                toCheck.push('speed_demon');
            }
            
            const accuracy = (appState.userData.correctAnswers / appState.userData.totalExercises) * 100;
            if (accuracy === 100 && appState.userData.totalExercises >= 10) {
                toCheck.push('perfect_score');
            }
            
            toCheck.forEach(achievementId => {
                if (!appState.userData.achievements.includes(achievementId)) {
                    unlockAchievement(achievementId);
                }
            });
        }

        function unlockAchievement(achievementId) {
            appState.userData.achievements.push(achievementId);
            const achievement = achievements.find(a => a.id === achievementId);
            
            if (achievement) {
                document.getElementById('unlockedIcon').textContent = achievement.icon;
                document.getElementById('unlockedName').textContent = achievement.name;
                document.getElementById('unlockedDescription').textContent = achievement.description;
                document.getElementById('achievementUnlock').classList.add('visible');
                
                setTimeout(() => {
                    document.getElementById('achievementUnlock').classList.remove('visible');
                }, 5000);
            }
        }

        function closeAchievementUnlock() {
            document.getElementById('achievementUnlock').classList.remove('visible');
        }

        function closeExerciseModal() {
            clearInterval(appState.timerInterval);
            document.getElementById('exerciseModal').style.display = 'none';
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabName + 'Tab').classList.add('active');
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
            
            if (tabName === 'stats') {
                loadStats();
            } else if (tabName === 'achievements') {
                loadAchievements();
            } else if (tabName === 'ranking') {
                loadRanking();
            }
        }

        function loadRanking() {
            const allUsers = Object.entries(appState.allUsersData);
            
            console.log('üìä Ranking - Total usuarios:', allUsers.length);
            console.log('üìä Usuarios:', allUsers);
            
            if (allUsers.length === 0) {
                showNoRankingData();
                return;
            }
            
            let filteredUsers = allUsers;
            let showingFiltered = false;
            
            if (appState.currentRankingFilter === 'week') {
                const weekAgo = new Date();
                weekAgo.setDate(weekAgo.getDate() - 7);
                const weekFiltered = allUsers.filter(([_, data]) => {
                    return data.completedDays && data.completedDays.some(day => new Date(day) >= weekAgo);
                });
                // Si hay resultados con el filtro, usarlos; si no, mostrar todos
                if (weekFiltered.length > 0) {
                    filteredUsers = weekFiltered;
                    showingFiltered = true;
                }
            } else if (appState.currentRankingFilter === 'month') {
                const monthAgo = new Date();
                monthAgo.setMonth(monthAgo.getMonth() - 1);
                const monthFiltered = allUsers.filter(([_, data]) => {
                    return data.completedDays && data.completedDays.some(day => new Date(day) >= monthAgo);
                });
                // Si hay resultados con el filtro, usarlos; si no, mostrar todos
                if (monthFiltered.length > 0) {
                    filteredUsers = monthFiltered;
                    showingFiltered = true;
                }
            }
            
            console.log('üìä Usuarios filtrados:', filteredUsers.length);
            
            // Ordenar usuarios por: 1) Logros, 2) Precisi√≥n, 3) Puntos totales
            const sortedUsers = filteredUsers.sort((a, b) => {
                const aAchievements = a[1].achievements ? a[1].achievements.length : 0;
                const bAchievements = b[1].achievements ? b[1].achievements.length : 0;
                
                // Primero por logros
                if (bAchievements !== aAchievements) {
                    return bAchievements - aAchievements;
                }
                
                // Luego por precisi√≥n (accuracy)
                const aAttempts = a[1].totalAttempts || 0;
                const bAttempts = b[1].totalAttempts || 0;
                const aAccuracy = aAttempts > 0 ? (a[1].correctAnswers || 0) / aAttempts : 0;
                const bAccuracy = bAttempts > 0 ? (b[1].correctAnswers || 0) / bAttempts : 0;
                
                if (Math.abs(bAccuracy - aAccuracy) > 0.01) { // Si hay diferencia significativa
                    return bAccuracy - aAccuracy;
                }
                
                // Finalmente por puntos totales
                return (b[1].totalPoints || 0) - (a[1].totalPoints || 0);
            });
            
            const podiumContainer = document.getElementById('podiumContainer');
            const tableContainer = document.getElementById('rankingTableContainer');
            podiumContainer.innerHTML = '';
            tableContainer.innerHTML = '';
            
            // Mostrar mensaje si estamos filtrando sin resultados del filtro
            if (!showingFiltered && appState.currentRankingFilter !== 'all') {
                const notice = document.createElement('div');
                notice.style.cssText = 'text-align: center; padding: 15px; background: #ffeaa7; border-radius: 15px; margin-bottom: 20px; border: 3px solid #fdcb6e;';
                notice.innerHTML = '<p style="font-weight: 700; color: #2d3436; margin: 0;">‚ÑπÔ∏è No hay actividad en este periodo. Mostrando todos los usuarios.</p>';
                podiumContainer.parentElement.insertBefore(notice, podiumContainer);
            }
            
            // PODIO - Mostrar top 3 (o menos si hay menos usuarios)
            const top3 = sortedUsers.slice(0, 3);
            if (top3.length > 0) {
                const podium = document.createElement('div');
                podium.className = 'podium';
                
                // Si solo hay 1 usuario
                if (top3.length === 1) {
                    const [username, data] = top3[0];
                    const accuracy = (data.totalAttempts || 0) > 0 
                        ? Math.round(((data.correctAnswers || 0) / data.totalAttempts) * 100)
                        : 0;
                    const place = document.createElement('div');
                    place.className = 'podium-place first';
                    place.innerHTML = `
                        <div class="podium-rank">ü•á</div>
                        <div class="podium-name">${username}</div>
                        <div class="podium-score">‚≠ê ${data.totalPoints || 0}</div>
                        <div class="podium-score">üéØ ${accuracy}%</div>
                        <div class="podium-score">üèÜ ${data.achievements ? data.achievements.length : 0}</div>
                    `;
                    podium.appendChild(place);
                } 
                // Si hay 2 usuarios
                else if (top3.length === 2) {
                    const correctMedals = ['ü•á', 'ü•à']; // Medallas correctas para 2 usuarios
                    [0, 1].forEach((index) => {
                        const [username, data] = top3[index];
                        const accuracy = (data.totalAttempts || 0) > 0 
                            ? Math.round(((data.correctAnswers || 0) / data.totalAttempts) * 100)
                            : 0;
                        const place = document.createElement('div');
                        place.className = `podium-place ${index === 0 ? 'first' : 'second'}`;
                        place.innerHTML = `
                            <div class="podium-rank">${correctMedals[index]}</div>
                            <div class="podium-name">${username}</div>
                            <div class="podium-score">‚≠ê ${data.totalPoints || 0}</div>
                            <div class="podium-score">üéØ ${accuracy}%</div>
                            <div class="podium-score">üèÜ ${data.achievements ? data.achievements.length : 0}</div>
                        `;
                        podium.appendChild(place);
                    });
                } 
                // Si hay 3 o m√°s usuarios - orden visual: 2do, 1ro, 3ro
                else {
                    const displayOrder = [
                        { arrayIndex: 1, position: 'second', medal: 'ü•à' },  // 2do lugar (izquierda)
                        { arrayIndex: 0, position: 'first', medal: 'ü•á' },   // 1er lugar (centro)
                        { arrayIndex: 2, position: 'third', medal: 'ü•â' }    // 3er lugar (derecha)
                    ];
                    
                    displayOrder.forEach(({ arrayIndex, position, medal }) => {
                        if (top3[arrayIndex]) {
                            const [username, data] = top3[arrayIndex];
                            const accuracy = (data.totalAttempts || 0) > 0 
                                ? Math.round(((data.correctAnswers || 0) / data.totalAttempts) * 100)
                                : 0;
                            const place = document.createElement('div');
                            place.className = `podium-place ${position}`;
                            place.innerHTML = `
                                <div class="podium-rank">${medal}</div>
                                <div class="podium-name">${username}</div>
                                <div class="podium-score">‚≠ê ${data.totalPoints || 0}</div>
                                <div class="podium-score">üéØ ${accuracy}%</div>
                                <div class="podium-score">üèÜ ${data.achievements ? data.achievements.length : 0}</div>
                            `;
                            podium.appendChild(place);
                        }
                    });
                }
                
                podiumContainer.appendChild(podium);
            }
            
            // TABLA - Mostrar el resto (posici√≥n 4 en adelante)
            const remainingUsers = sortedUsers.slice(3);
            if (remainingUsers.length > 0) {
                remainingUsers.forEach(([username, data], index) => {
                    const accuracy = (data.totalAttempts || 0) > 0 
                        ? Math.round(((data.correctAnswers || 0) / data.totalAttempts) * 100)
                        : 0;
                    const row = document.createElement('div');
                    row.className = 'ranking-row';
                    if (username === appState.currentUser) {
                        row.classList.add('current-user');
                    }
                    
                    row.innerHTML = `
                        <div class="ranking-position">#${index + 4}</div>
                        <div class="ranking-user">${username}</div>
                        <div class="ranking-stats">
                            <span>‚≠ê ${data.totalPoints || 0}</span>
                            <span>üéØ ${accuracy}%</span>
                            <span>üèÜ ${data.achievements ? data.achievements.length : 0}</span>
                            <span>üî• ${data.streak || 0}</span>
                        </div>
                    `;
                    
                    tableContainer.appendChild(row);
                });
            } else if (sortedUsers.length <= 3) {
                // Si hay 3 o menos usuarios, mostrar un mensaje amigable
                tableContainer.innerHTML = `
                    <div style="text-align: center; padding: 30px; background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-radius: 20px; border: 3px solid #74b9ff; margin-top: 20px;">
                        <div style="font-size: 60px; margin-bottom: 15px;">üéØ</div>
                        <h4 style="font-family: 'Fredoka One', cursive; font-size: 20px; color: #2d3436; margin-bottom: 10px;">¬°Top ${sortedUsers.length} de entrenadores!</h4>
                        <p style="font-size: 16px; color: #636e72; font-weight: 600;">¬°Invita a m√°s amigos para competir! üöÄ</p>
                    </div>
                `;
            }
            
            console.log('üìä Ranking cargado - Podio:', top3.length, 'Tabla:', remainingUsers.length);
        }

        function setRankingFilter(filter) {
            appState.currentRankingFilter = filter;
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            loadRanking();
        }

        function showNoRankingData() {
            const podiumContainer = document.getElementById('podiumContainer');
            const tableContainer = document.getElementById('rankingTableContainer');
            
            podiumContainer.innerHTML = '';
            tableContainer.innerHTML = `
                <div style="text-align: center; padding: 50px; background: white; border-radius: 20px; border: 3px solid #74b9ff;">
                    <div style="font-size: 80px; margin-bottom: 20px;">üåü</div>
                    <h3 style="font-family: 'Fredoka One', cursive; font-size: 24px; color: #2d3436; margin-bottom: 15px;">¬°S√© el primer s√∫per entrenador!</h3>
                    <p style="font-size: 16px; color: #636e72; font-weight: 600;">Completa algunos ejercicios geniales para aparecer en el ranking de campeones.</p>
                </div>
            `;
        }

        function loadStats() {
            try {
                const content = document.getElementById('statsContent');
                const userData = appState.userData || createNewUser();
                
                console.log('üìä LoadStats - userData:', userData);
                console.log('üìä LoadStats - content element:', content);
                
                if (!content) {
                    console.error('‚ùå No se encontr√≥ el elemento statsContent');
                    return;
                }
                
                // Asegurar que existan los campos necesarios con valores por defecto
                const totalAttempts = userData.totalAttempts || 0;
                const correctAnswers = userData.correctAnswers || 0;
                const wrongAnswers = userData.wrongAnswers || 0;
                const totalExercises = userData.totalExercises || 0;
                
                // Calcular precisi√≥n (accuracy)
                const accuracy = totalAttempts > 0 
                    ? Math.round((correctAnswers / totalAttempts) * 100)
                    : 0;
                
                // Determinar nivel de precisi√≥n y emoji
                let accuracyEmoji = 'üéØ';
                let accuracyClass = '';
                if (accuracy >= 90) {
                    accuracyEmoji = 'üèÜ';
                    accuracyClass = 'excellent';
                } else if (accuracy >= 75) {
                    accuracyEmoji = '‚≠ê';
                    accuracyClass = 'good';
                } else if (accuracy >= 50) {
                    accuracyEmoji = 'üìà';
                    accuracyClass = 'ok';
                } else {
                    accuracyEmoji = 'üí™';
                    accuracyClass = 'needs-work';
                }
                
                const allUsers = Object.entries(appState.allUsersData || {});
                const sortedByAchievements = allUsers.sort((a, b) => {
                    const aAchievements = a[1].achievements ? a[1].achievements.length : 0;
                    const bAchievements = b[1].achievements ? b[1].achievements.length : 0;
                    if (bAchievements !== aAchievements) {
                        return bAchievements - aAchievements;
                    }
                    return (b[1].totalPoints || 0) - (a[1].totalPoints || 0);
                });
                
                const userRankPosition = sortedByAchievements.findIndex(([username]) => username === appState.currentUser) + 1;
                
                content.innerHTML = `
                    <div class="stats-kids">
                        <div class="stat-card-big">
                            <div class="stat-icon-big">üéØ</div>
                            <div class="stat-number-big">${totalExercises}</div>
                            <div class="stat-label-big">Ejercicios S√∫per Completados</div>
                        </div>
                        
                        <div class="stat-card-big">
                            <div class="stat-icon-big">${accuracyEmoji}</div>
                            <div class="stat-number-big">${accuracy}%</div>
                            <div class="stat-label-big">Precisi√≥n (Aciertos a la Primera)</div>
                        </div>
                        
                        <div class="stat-card-big">
                            <div class="stat-icon-big">üèÜ</div>
                            <div class="stat-number-big">${userRankPosition > 0 ? `#${userRankPosition}` : 'üåü'}</div>
                            <div class="stat-label-big">Mi Posici√≥n en el Ranking</div>
                        </div>
                        
                        <div class="stat-card-big">
                            <div class="stat-icon-big">üéñÔ∏è</div>
                            <div class="stat-number-big">${userData.achievements ? userData.achievements.length : 0}</div>
                            <div class="stat-label-big">Logros S√∫per Geniales</div>
                        </div>
                        
                        <div class="stat-card-big">
                            <div class="stat-icon-big">üî•</div>
                            <div class="stat-number-big">${userData.streak || 0}</div>
                            <div class="stat-label-big">D√≠as Seguidos Geniales</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #fff3cd, #ffe69c); border-radius: 20px; border: 3px solid #ffc107;">
                        <h4 style="font-family: 'Fredoka One', cursive; font-size: 20px; text-align: center; margin-bottom: 15px; color: #856404;">üí° Sistema de Puntos</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; font-weight: 700; font-size: 15px; color: #856404;">
                            <div>‚úÖ Respuesta correcta: <span style="color: #28a745;">+10 puntos</span></div>
                            <div>‚ùå Respuesta incorrecta: <span style="color: #dc3545;">-3 puntos</span></div>
                            <div>üéØ Tu precisi√≥n: <strong style="font-size: 18px;">${accuracy}%</strong></div>
                        </div>
                        <p style="margin-top: 15px; text-align: center; font-weight: 600; color: #856404; font-size: 14px;">
                            üí≠ ¬°Piensa bien antes de responder! Cada error resta puntos.
                        </p>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 25px; background: white; border-radius: 20px; border: 3px solid #17a2b8;">
                        <h4 style="font-family: 'Fredoka One', cursive; font-size: 20px; text-align: center; margin-bottom: 20px; color: #2d3436;">üìà Mis N√∫meros Detallados</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; text-align: center;">
                            <div style="padding: 15px; background: #d4edda; border-radius: 15px; border: 3px solid #28a745;">
                                <div style="font-size: 32px; margin-bottom: 5px;">‚úÖ</div>
                                <div style="font-family: 'Fredoka One', cursive; font-size: 24px; color: #155724;">${correctAnswers}</div>
                                <div style="font-weight: 700; color: #155724; font-size: 14px;">Aciertos</div>
                            </div>
                            <div style="padding: 15px; background: #f8d7da; border-radius: 15px; border: 3px solid #dc3545;">
                                <div style="font-size: 32px; margin-bottom: 5px;">‚ùå</div>
                                <div style="font-family: 'Fredoka One', cursive; font-size: 24px; color: #721c24;">${wrongAnswers}</div>
                                <div style="font-weight: 700; color: #721c24; font-size: 14px;">Errores</div>
                            </div>
                            <div style="padding: 15px; background: #d1ecf1; border-radius: 15px; border: 3px solid #17a2b8;">
                                <div style="font-size: 32px; margin-bottom: 5px;">üìù</div>
                                <div style="font-family: 'Fredoka One', cursive; font-size: 24px; color: #0c5460;">${totalAttempts}</div>
                                <div style="font-weight: 700; color: #0c5460; font-size: 14px;">Intentos Totales</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 40px; padding: 30px; background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-radius: 25px; border: 3px solid #74b9ff;">
                        <h3 style="font-family: 'Fredoka One', cursive; font-size: 28px; text-align: center; margin-bottom: 30px; color: #2d3436;">üìä ¬°Mis N√∫meros por Materia!</h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                            <div style="text-align: center; padding: 20px; background: white; border-radius: 15px; border: 3px solid #ff6b6b;">
                                <div style="font-size: 40px; margin-bottom: 10px;">üßÆ</div>
                                <div style="font-family: 'Fredoka One', cursive; font-size: 24px; color: #ff6b6b;">${(userData.exercisesByType && userData.exercisesByType.math) || 0}</div>
                                <div style="font-weight: 700; color: #636e72;">Mates Geniales</div>
                            </div>
                            
                            <div style="text-align: center; padding: 20px; background: white; border-radius: 15px; border: 3px solid #4ecdc4;">
                                <div style="font-size: 40px; margin-bottom: 10px;">üìñ</div>
                                <div style="font-family: 'Fredoka One', cursive; font-size: 24px; color: #4ecdc4;">${(userData.exercisesByType && userData.exercisesByType.reading) || 0}</div>
                                <div style="font-weight: 700; color: #636e72;">S√∫per Lectura</div>
                            </div>
                            
                            <div style="text-align: center; padding: 20px; background: white; border-radius: 15px; border: 3px solid #74b9ff;">
                                <div style="font-size: 40px; margin-bottom: 10px;">üî¨</div>
                                <div style="font-family: 'Fredoka One', cursive; font-size: 24px; color: #74b9ff;">${(userData.exercisesByType && userData.exercisesByType.science) || 0}</div>
                                <div style="font-weight: 700; color: #636e72;">Ciencias Naturales</div>
                            </div>
                            
                            <div style="text-align: center; padding: 20px; background: white; border-radius: 15px; border: 3px solid #a29bfe;">
                                <div style="font-size: 40px; margin-bottom: 10px;">üåç</div>
                                <div style="font-family: 'Fredoka One', cursive; font-size: 24px; color: #a29bfe;">${(userData.exercisesByType && userData.exercisesByType.social) || 0}</div>
                                <div style="font-weight: 700; color: #636e72;">Ciencias Sociales</div>
                            </div>
                        </div>
                    </div>
                `;
                
                console.log('‚úÖ LoadStats completado exitosamente');
            } catch (error) {
                console.error('‚ùå Error en loadStats:', error);
                const content = document.getElementById('statsContent');
                if (content) {
                    content.innerHTML = '<p style="text-align: center; color: red; padding: 20px;">Error al cargar estad√≠sticas. Por favor, recarga la p√°gina.</p>';
                }
            }
        }

        function loadAchievements() {
            const grid = document.getElementById('achievementGrid');
            grid.innerHTML = '';
            
            const userData = appState.userData || createNewUser();
            
            achievements.forEach(achievement => {
                const isUnlocked = userData.achievements && userData.achievements.includes(achievement.id);
                
                const card = document.createElement('div');
                card.className = `achievement-card ${isUnlocked ? 'unlocked' : ''}`;
                
                card.innerHTML = `
                    <div class="achievement-icon">${achievement.icon}</div>
                    <h4 style="font-family: 'Fredoka One', cursive; margin-bottom: 10px;">${achievement.name}</h4>
                    <p style="font-weight: 600; font-size: 14px;">${achievement.description}</p>
                    <div style="margin-top: 15px; font-size: 14px; font-weight: 700;">
                        ${isUnlocked ? 'üéâ ¬°DESBLOQUEADO!' : 'üîê Bloqueado'}
                    </div>
                `;
                
                grid.appendChild(card);
            });
        }

        async function testConnection() {
            updateConnectionStatus('connecting');
            try {
                const response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${JSONBIN_CONFIG.binId}/latest`, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': JSONBIN_CONFIG.masterKey
                    }
                });
                
                if (response.ok) {
                    updateConnectionStatus('online');
                    alert('‚úÖ ¬°Conexi√≥n s√∫per exitosa con JSONBin.io! üéâ');
                    await loadUserData();
                } else {
                    updateConnectionStatus('error');
                    alert('‚ùå Error de conexi√≥n: ' + response.status);
                }
            } catch (error) {
                updateConnectionStatus('error');
                alert('‚ùå Error de red: ' + error.message);
            }
        }

        function resetProgress() {
            if (confirm('¬øEst√°s s√∫per seguro de que quieres empezar de nuevo? ¬°Perder√°s todos tus logros geniales! üò±')) {
                appState.userData = createNewUser();
                saveUserData();
                updateUserInterface();
                generateWeeks();
                alert('üéâ ¬°Progreso reiniciado! ¬°Nueva aventura comenzando! üöÄ');
            }
        }

        function exportData() {
            const dataToExport = {
                user: appState.currentUser,
                data: appState.userData,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(dataToExport, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `academia_pokemon_${appState.currentUser}_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            alert('üì• ¬°Datos s√∫per descargados! üéâ');
        }

        async function deleteUser() {
            const confirmMessage = `‚ö†Ô∏è ATENCI√ìN ‚ö†Ô∏è\n\n¬øEst√°s COMPLETAMENTE seguro de que quieres ELIMINAR tu usuario "${appState.currentUser}"?\n\nEsta acci√≥n:\n- Borrar√° PERMANENTEMENTE todos tus datos del servidor\n- NO se puede deshacer\n- Perder√°s TODOS tus puntos, logros y progreso\n\nEscribe "${appState.currentUser}" para confirmar:`;
            
            const confirmation = prompt(confirmMessage);
            
            if (confirmation === appState.currentUser) {
                try {
                    updateConnectionStatus('connecting');
                    
                    // Eliminar el usuario de allUsersData
                    delete appState.allUsersData[appState.currentUser];
                    
                    // Guardar en el servidor
                    const response = await fetch(`${JSONBIN_CONFIG.apiUrl}/b/${JSONBIN_CONFIG.binId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': JSONBIN_CONFIG.masterKey
                        },
                        body: JSON.stringify(appState.allUsersData)
                    });
                    
                    if (response.ok) {
                        updateConnectionStatus('online');
                        alert('‚úÖ Usuario eliminado correctamente del servidor.\n\n¬°Hasta pronto! üëã');
                        
                        // Limpiar estado y volver al login
                        appState.currentUser = null;
                        appState.userData = null;
                        
                        document.getElementById('mainApp').style.display = 'none';
                        document.getElementById('loginScreen').style.display = 'flex';
                        document.getElementById('usernameInput').value = '';
                    } else {
                        throw new Error('Error al eliminar del servidor');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    updateConnectionStatus('error');
                    alert('‚ùå Error al eliminar el usuario del servidor.\n\nPor favor, int√©ntalo de nuevo.');
                }
            } else if (confirmation !== null) {
                alert('‚ùå Confirmaci√≥n incorrecta. No se ha eliminado el usuario.');
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            console.log('üéÆ Academia Pokemon iniciada - Versi√≥n 4.0 FINAL');
            
            updateConnectionStatus('offline');
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            
            document.getElementById('usernameInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });

            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    showTab(tabName);
                });
            });
        });
    </script>
</body>
</html>
